<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>RNA editing project - IBD pooled dataset cleaning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">RNA editing project</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">IBD pooled dataset cleaning</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">IBD dataset</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../IBD/results/01A_Seurat_import_clean.html" class="sidebar-item-text sidebar-link active">Seurat cleaning</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Crohn disease dataset</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">COTAN cleaning</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Crohn_disease/results/01_cleaning_patient5_NB.html" class="sidebar-item-text sidebar-link">patient 5 ileum</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Crohn_disease/results/01_cleaning_patient7_NB.html" class="sidebar-item-text sidebar-link">patient 7 ileum</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Crohn_disease/results/01_cleaning_patient8_NB.html" class="sidebar-item-text sidebar-link">patient 8 ileum</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Crohn_disease/results/01_cleaning_patient10_NB.html" class="sidebar-item-text sidebar-link">patient 10 ileum</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Crohn_disease/results/01_cleaning_patient11_NB.html" class="sidebar-item-text sidebar-link">patient 11 ileum</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Crohn_disease/results/01_cleaning_patient12_NB.html" class="sidebar-item-text sidebar-link">patient 12 ileum</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Crohn_disease/results/01_cleaning_patient14_NB.html" class="sidebar-item-text sidebar-link">patient 14 ileum</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">Data exploration &amp; Cluster identification</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Crohn_disease/results/04_Data_exploration_clusters_id_patient5_NB.html" class="sidebar-item-text sidebar-link">patient 5 ileum</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Crohn_disease/results/04_Data_exploration_clusters_id_patient7_NB.html" class="sidebar-item-text sidebar-link">patient 7 ileum</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Crohn_disease/results/04_Data_exploration_clusters_id_patient8_NB.html" class="sidebar-item-text sidebar-link">patient 8 ileum</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Crohn_disease/results/04_Data_exploration_clusters_id_patient10_NB.html" class="sidebar-item-text sidebar-link">patient 10 ileum</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Crohn_disease/results/04_Data_exploration_clusters_id_patient11_NB.html" class="sidebar-item-text sidebar-link">patient 11 ileum</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Crohn_disease/results/04_Data_exploration_clusters_id_patient12_NB.html" class="sidebar-item-text sidebar-link">patient 12 ileum</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Crohn_disease/results/04_Data_exploration_clusters_id_patient14_NB.html" class="sidebar-item-text sidebar-link">patient 14 ileum</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">Summary and Conclusion</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Crohn_disease/results/05_HeatmapSummary_NB.html" class="sidebar-item-text sidebar-link">Heatmaps summary</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#colitis-data-set" id="toc-colitis-data-set" class="nav-link active" data-scroll-target="#colitis-data-set">Colitis data set</a>
  <ul class="collapse">
  <li><a href="#cell-cycle-score" id="toc-cell-cycle-score" class="nav-link" data-scroll-target="#cell-cycle-score">Cell cycle score</a></li>
  </ul></li>
  <li><a href="#control-data-set" id="toc-control-data-set" class="nav-link" data-scroll-target="#control-data-set">Control data set</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">IBD pooled dataset cleaning</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Seurat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Attaching SeuratObject</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Attaching sp</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="colitis-data-set" class="level1">
<h1>Colitis data set</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>matrix.col <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/01_raw_data/GSE121380_Col1-6_5prime_raw_gene_expression.txt.gz"</span>,<span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(matrix.col) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Col_"</span>,<span class="fu">colnames</span>(matrix.col))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">CreateSeuratObject</span>(matrix.col,<span class="at">project =</span> <span class="st">"RNA editing"</span>,<span class="at">names.field =</span> <span class="dv">2</span>,<span class="at">names.delim =</span> <span class="st">"[.]"</span>,<span class="at">min.cells =</span> <span class="dv">3</span>, <span class="at">min.features =</span> <span class="dv">200</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Feature names cannot have underscores ('_'), replacing with dashes
('-')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>srat[[<span class="st">"percent.mt"</span>]] <span class="ot">&lt;-</span> <span class="fu">PercentageFeatureSet</span>(srat, <span class="at">pattern =</span> <span class="st">"^MT-"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>srat[[<span class="st">"percent.rb"</span>]] <span class="ot">&lt;-</span> <span class="fu">PercentageFeatureSet</span>(srat, <span class="at">pattern =</span> <span class="st">"^RP[SL]"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(srat, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"nFeature_RNA"</span>,<span class="st">"nCount_RNA"</span>,<span class="st">"percent.rb"</span>,<span class="st">"percent.mt"</span>),<span class="at">ncol =</span> <span class="dv">2</span>,<span class="at">pt.size =</span> <span class="fl">0.1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In the original paper, there arenâ€™t the cleaning parameters! Notice also that sample number 4, and, to some extent, also the number 5, are quite different: quite fewer RNA molecules detected, lower number of genes detected, and lower ribosomal genes but higher mitochondrial RNA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">subset</span>(srat, <span class="at">subset =</span> nFeature_RNA <span class="sc">&gt;</span> <span class="dv">200</span> <span class="sc">&amp;</span> nFeature_RNA <span class="sc">&lt;</span> <span class="dv">4000</span> <span class="sc">&amp;</span> percent.mt <span class="sc">&lt;</span> <span class="dv">15</span> <span class="sc">&amp;</span>  nCount_RNA <span class="sc">&lt;</span> <span class="dv">20000</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(srat, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"nFeature_RNA"</span>,<span class="st">"nCount_RNA"</span>,<span class="st">"percent.rb"</span>,<span class="st">"percent.mt"</span>),<span class="at">ncol =</span> <span class="dv">2</span>,<span class="at">pt.size =</span> <span class="fl">0.1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">FeatureScatter</span>(srat, <span class="at">feature1 =</span> <span class="st">"nCount_RNA"</span>, <span class="at">feature2 =</span> <span class="st">"nFeature_RNA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">FeatureScatter</span>(srat, <span class="at">feature1 =</span> <span class="st">"nCount_RNA"</span>, <span class="at">feature2 =</span> <span class="st">"percent.mt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">hist</span>(srat<span class="sc">$</span>nFeature_RNA<span class="sc">/</span>srat<span class="sc">$</span>nCount_RNA, <span class="at">breaks =</span> <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
 [1] 0.05 0.06 0.07 0.08 0.09 0.10 0.11 0.12 0.13 0.14 0.15 0.16 0.17 0.18 0.19
[16] 0.20 0.21 0.22 0.23 0.24 0.25 0.26 0.27 0.28 0.29 0.30 0.31 0.32 0.33 0.34
[31] 0.35 0.36 0.37 0.38 0.39 0.40 0.41 0.42 0.43 0.44 0.45 0.46 0.47 0.48 0.49
[46] 0.50 0.51 0.52 0.53 0.54 0.55 0.56 0.57 0.58 0.59 0.60 0.61 0.62 0.63 0.64
[61] 0.65 0.66 0.67 0.68 0.69 0.70 0.71 0.72 0.73 0.74 0.75 0.76 0.77 0.78 0.79

$counts
 [1]    2    3    4    5    9    5    8   14   10   11    7   15   18   14   18
[16]   39   48   72   96  147  199  291  393  529  648  833  942 1176 1322 1506
[31] 1602 1743 1754 1674 1666 1474 1218 1023  863  683  563  431  353  266  200
[46]  131  127   80   66   58   50   29   35   34   21   16   21   23   16    5
[61]   10    9    8    3    2    3    3    3    3    4    1    2    2    1

$density
 [1] 0.008109314 0.012163970 0.016218627 0.020273284 0.036491911 0.020273284
 [7] 0.032437254 0.056765195 0.040546568 0.044601225 0.028382597 0.060819852
[13] 0.072983822 0.056765195 0.072983822 0.158131614 0.194623525 0.291935288
[19] 0.389247050 0.596034546 0.806876698 1.179905121 1.593480112 2.144913433
[25] 2.627417589 3.377529092 3.819486680 4.768276365 5.360256254 6.106313101
[31] 6.495560151 7.067266756 7.111867980 6.787495439 6.755058184 5.976564084
[37] 4.938571950 4.147913879 3.499168795 2.769330576 2.282771763 1.747557069
[43] 1.431293841 1.078538702 0.810931355 0.531160037 0.514941410 0.324372542
[49] 0.267607347 0.235170093 0.202732839 0.117585046 0.141912987 0.137858330
[55] 0.085147792 0.064874508 0.085147792 0.093257106 0.064874508 0.020273284
[61] 0.040546568 0.036491911 0.032437254 0.012163970 0.008109314 0.012163970
[67] 0.012163970 0.012163970 0.012163970 0.016218627 0.004054657 0.008109314
[73] 0.008109314 0.004054657

$mids
 [1] 0.055 0.065 0.075 0.085 0.095 0.105 0.115 0.125 0.135 0.145 0.155 0.165
[13] 0.175 0.185 0.195 0.205 0.215 0.225 0.235 0.245 0.255 0.265 0.275 0.285
[25] 0.295 0.305 0.315 0.325 0.335 0.345 0.355 0.365 0.375 0.385 0.395 0.405
[37] 0.415 0.425 0.435 0.445 0.455 0.465 0.475 0.485 0.495 0.505 0.515 0.525
[49] 0.535 0.545 0.555 0.565 0.575 0.585 0.595 0.605 0.615 0.625 0.635 0.645
[61] 0.655 0.665 0.675 0.685 0.695 0.705 0.715 0.725 0.735 0.745 0.755 0.765
[73] 0.775 0.785

$xname
[1] "srat$nFeature_RNA/srat$nCount_RNA"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">NormalizeData</span>(srat)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">FindVariableFeatures</span>(srat, <span class="at">selection.method =</span> <span class="st">"vst"</span>, <span class="at">nfeatures =</span> <span class="dv">2000</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>top10 <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">VariableFeatures</span>(srat), <span class="dv">15</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">VariableFeaturePlot</span>(srat)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">LabelPoints</span>(<span class="at">plot =</span> plot1, <span class="at">points =</span> top10, <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">xnudge =</span> <span class="dv">0</span>, <span class="at">ynudge =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 13 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: ggrepel: 9 unlabeled data points (too many overlaps). Consider
increasing max.overlaps</code></pre>
</div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>all.genes <span class="ot">&lt;-</span> <span class="fu">rownames</span>(srat)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">ScaleData</span>(srat, <span class="at">features =</span> all.genes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Centering and scaling data matrix</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">RunPCA</span>(srat, <span class="at">features =</span> <span class="fu">VariableFeatures</span>(<span class="at">object =</span> srat),<span class="at">npcs =</span> <span class="dv">75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>PC_ 1 
Positive:  RGS13, STMN1, MEF2B, TYMS, RRM2, NUSAP1, KIAA0101, CDCA7, TK1, MKI67 
       KIFC1, CCNA2, BIRC5, UBE2C, CDT1, CDK1, CDKN3, ELL3, TOP2A, CENPM 
       CDCA3, HMGB2, MND1, POU2AF1, TPX2, UBE2J1, DHFR, UHRF1, MYBL2, HMGN2 
Negative:  B2M, IFITM1, IL32, CD3E, CD3D, CD7, FYB, CD3G, CD2, CCL5 
       CD96, CD247, RARRES3, ITM2A, GIMAP7, CST7, SRGN, NKG7, HLA-B, IL2RB 
       LAT, S100A6, TNFAIP3, S100A4, GZMM, CD69, NR4A2, PRKCH, FYN, GIMAP4 
PC_ 2 
Positive:  PHGR1, LGALS4, FABP1, KRT8, IFI27, C19orf33, FXYD3, C15orf48, CA2, SMIM22 
       TMEM54, PKIB, SLC26A3, ANPEP, KRT18, LGALS3, TSPAN8, SDCBP2, EPCAM, PRSS3 
       CEACAM7, AQP8, SFN, PIGR, KRT20, ELF3, CKB, TST, CLDN7, SEPP1 
Negative:  EEF1A1, RPLP1, RPL28, MT-CO2, RPLP0, B2M, ACTB, PTMA, MALAT1, CD3E 
       CD3D, CD69, CD7, IFITM1, PPIA, VIM, CD3G, CD2, CCL5, SRGN 
       ZFP36, CD247, CD96, PFN1, ITM2A, CD74, NR4A2, HLA-B, RGS1, FYN 
PC_ 3 
Positive:  IL32, CD3E, CD7, CD3D, CCL5, CD3G, NKG7, CD247, CST7, CD96 
       CD2, IL2RB, RARRES3, FYB, SRGN, KLRD1, TNFAIP3, FYN, PRKCH, GZMM 
       TMIGD2, ID2, IFITM1, ITM2A, HOPX, SH2D2A, GIMAP7, CD8A, CTSW, LAT 
Negative:  HLA-DRA, CD79A, HLA-DQA1, MS4A1, CD74, HLA-DRB1, VPREB3, CD83, FCER2, LTB 
       HLA-DRB5, TCL1A, CD40, CR2, IGHM, PHACTR1, KLF2, CTSH, BASP1, CD24 
       SPIB, HERPUD1, PLD4, IRF8, AC079767.4, HLA-DQA2, SCIMP, EAF2, GRN, KIAA0226L 
PC_ 4 
Positive:  TCF7, CD4, SPOCK2, PDCD1, PASK, CD28, CD5, IL6R, IL6ST, TC2N 
       GPR183, CD6, CTLA4, TOX2, CCR7, CCNA2, UBE2C, ACTN1, PLK1, TOP2A 
       LAT, CDCA3, ICOS, GTSE1, MAF, DLGAP5, AURKB, CDCA8, CENPA, CKAP2L 
Negative:  HOPX, NKG7, CCL5, KLRD1, KIR2DL4, MEF2B, GSTP1, GZMA, GAPDH, SERPINA9 
       MYO1E, FCER1G, RGS13, GZMB, ITGA1, CD63, ACTG1, LGALS1, CST7, ELL3 
       PRF1, FASLG, TPI1, RHOC, CTSW, SH2D1B, TMIGD2, CCL4, SERF2, CLIC3 
PC_ 5 
Positive:  HLA-DRB1, HLA-DQA1, HLA-DRA, FTL, FCER2, PLK1, CENPA, DLGAP5, KIR2DL4, UBE2C 
       CD74, KLF2, HOPX, CDC20, VIM, CCNA2, CCL5, KLRD1, CDCA3, NKG7 
       CDCA8, GTSE1, CKAP2L, AURKB, HMMR, CD63, CCNB2, ASPM, GZMA, TOP2A 
Negative:  PDCD1, PASK, TOX2, CD4, TCF7, LAT, CTLA4, MEF2B, CORO1B, FKBP5 
       MAF, IL6R, SH2D1A, CD28, ICOS, IL6ST, SERPINA9, TC2N, CD6, SMCO4 
       CD5, RGS13, SPOCK2, CD2, GNG4, ISG20, TBC1D4, ITM2A, ACTN1, MAGEH1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(srat, <span class="at">reduction =</span> <span class="st">"pca"</span>,<span class="at">dims =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">group.by =</span> <span class="st">"orig.ident"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(srat, <span class="at">reduction =</span> <span class="st">"pca"</span>,<span class="at">dims =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">group.by =</span> <span class="st">"orig.ident"</span>,<span class="at">split.by =</span> <span class="st">"orig.ident"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ElbowPlot</span>(srat,<span class="at">ndims =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ElbowPlot(srat, ndims = 100): The object only has information for 75
reductions</code></pre>
</div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">RunUMAP</span>(srat, <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>, <span class="at">verbose =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric
To use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation'
This message will be shown once per session</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(srat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>So we decided to drop cell set number 4 and 5.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">CreateSeuratObject</span>(matrix.col[,<span class="fu">str_ends</span>(<span class="fu">colnames</span>(matrix.col),<span class="at">pattern =</span> <span class="st">"[4-5]"</span>,<span class="at">negate =</span> T)],<span class="at">project =</span> <span class="st">"RNA editing"</span>,<span class="at">names.field =</span> <span class="dv">2</span>,<span class="at">names.delim =</span> <span class="st">"[.]"</span>,<span class="at">min.cells =</span> <span class="dv">3</span>, <span class="at">min.features =</span> <span class="dv">200</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Feature names cannot have underscores ('_'), replacing with dashes
('-')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>srat[[<span class="st">"percent.mt"</span>]] <span class="ot">&lt;-</span> <span class="fu">PercentageFeatureSet</span>(srat, <span class="at">pattern =</span> <span class="st">"^MT-"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>srat[[<span class="st">"percent.rb"</span>]] <span class="ot">&lt;-</span> <span class="fu">PercentageFeatureSet</span>(srat, <span class="at">pattern =</span> <span class="st">"^RP"</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(srat, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"nFeature_RNA"</span>,<span class="st">"nCount_RNA"</span>,<span class="st">"percent.rb"</span>,<span class="st">"percent.mt"</span>),<span class="at">ncol =</span> <span class="dv">2</span>,<span class="at">pt.size =</span> <span class="fl">0.1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">subset</span>(srat, <span class="at">subset =</span> nFeature_RNA <span class="sc">&gt;</span> <span class="dv">200</span> <span class="sc">&amp;</span> nFeature_RNA <span class="sc">&lt;</span> <span class="dv">4000</span> <span class="sc">&amp;</span> percent.mt <span class="sc">&lt;</span> <span class="dv">12</span> <span class="sc">&amp;</span>  nCount_RNA <span class="sc">&lt;</span> <span class="dv">15000</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(srat, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"nFeature_RNA"</span>,<span class="st">"nCount_RNA"</span>,<span class="st">"percent.rb"</span>,<span class="st">"percent.mt"</span>),<span class="at">ncol =</span> <span class="dv">2</span>,<span class="at">pt.size =</span> <span class="fl">0.1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">FeatureScatter</span>(srat, <span class="at">feature1 =</span> <span class="st">"nCount_RNA"</span>, <span class="at">feature2 =</span> <span class="st">"nFeature_RNA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">FeatureScatter</span>(srat, <span class="at">feature1 =</span> <span class="st">"nCount_RNA"</span>, <span class="at">feature2 =</span> <span class="st">"percent.mt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">hist</span>(srat<span class="sc">$</span>nFeature_RNA<span class="sc">/</span>srat<span class="sc">$</span>nCount_RNA, <span class="at">breaks =</span> <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
  [1] 0.055 0.060 0.065 0.070 0.075 0.080 0.085 0.090 0.095 0.100 0.105 0.110
 [13] 0.115 0.120 0.125 0.130 0.135 0.140 0.145 0.150 0.155 0.160 0.165 0.170
 [25] 0.175 0.180 0.185 0.190 0.195 0.200 0.205 0.210 0.215 0.220 0.225 0.230
 [37] 0.235 0.240 0.245 0.250 0.255 0.260 0.265 0.270 0.275 0.280 0.285 0.290
 [49] 0.295 0.300 0.305 0.310 0.315 0.320 0.325 0.330 0.335 0.340 0.345 0.350
 [61] 0.355 0.360 0.365 0.370 0.375 0.380 0.385 0.390 0.395 0.400 0.405 0.410
 [73] 0.415 0.420 0.425 0.430 0.435 0.440 0.445 0.450 0.455 0.460 0.465 0.470
 [85] 0.475 0.480 0.485 0.490 0.495 0.500 0.505 0.510 0.515 0.520 0.525 0.530
 [97] 0.535 0.540 0.545 0.550 0.555 0.560 0.565 0.570 0.575 0.580 0.585 0.590
[109] 0.595 0.600 0.605 0.610 0.615 0.620 0.625 0.630 0.635 0.640 0.645 0.650
[121] 0.655 0.660 0.665 0.670 0.675 0.680 0.685

$counts
  [1]   1   0   1   0   1   0   0   1   4   2   2   2   3   2   3   2   3   6
 [19]   2   3   2   7   6   3   7   0   7   5   9   7  10   7  14  22  23  32
 [37]  43  50  82  90  99 127 160 195 192 250 270 309 331 401 426 438 487 574
 [55] 590 605 699 745 741 758 824 835 874 874 856 831 808 850 792 750 705 637
 [73] 548 533 465 460 380 347 315 288 254 228 191 167 166 130 110  91  88  66
 [91]  46  59  49  41  28  32  21  19  16  12  16   9   9   8   7   8   3   4
[109]   2   5   0   2   3   2   3   1   1   0   0   0   1   0   0   0   0   1

$density
  [1] 0.00842744 0.00000000 0.00842744 0.00000000 0.00842744 0.00000000
  [7] 0.00000000 0.00842744 0.03370976 0.01685488 0.01685488 0.01685488
 [13] 0.02528232 0.01685488 0.02528232 0.01685488 0.02528232 0.05056464
 [19] 0.01685488 0.02528232 0.01685488 0.05899208 0.05056464 0.02528232
 [25] 0.05899208 0.00000000 0.05899208 0.04213720 0.07584696 0.05899208
 [31] 0.08427440 0.05899208 0.11798416 0.18540367 0.19383111 0.26967807
 [37] 0.36237991 0.42137199 0.69105006 0.75846958 0.83431653 1.07028485
 [43] 1.34839036 1.64335075 1.61806843 2.10685994 2.27540873 2.60407888
 [49] 2.78948256 3.37940334 3.59008933 3.69121861 4.10416316 4.83735041
 [55] 4.97218945 5.09860105 5.89078038 6.27844261 6.24473285 6.38799933
 [61] 6.94421035 7.03691219 7.36558234 7.36558234 7.21388842 7.00320243
 [67] 6.80937131 7.16332378 6.67453228 6.32057981 5.94134502 5.36827912
 [73] 4.61823698 4.49182538 3.91875948 3.87662228 3.20242710 2.92432159
 [79] 2.65464352 2.42710265 2.14056969 1.92145626 1.60964099 1.40738244
 [85] 1.39895500 1.09556717 0.92701837 0.76689702 0.74161470 0.55621102
 [91] 0.38766223 0.49721894 0.41294455 0.34552503 0.23596831 0.26967807
 [97] 0.17697623 0.16012136 0.13483904 0.10112928 0.13483904 0.07584696
[103] 0.07584696 0.06741952 0.05899208 0.06741952 0.02528232 0.03370976
[109] 0.01685488 0.04213720 0.00000000 0.01685488 0.02528232 0.01685488
[115] 0.02528232 0.00842744 0.00842744 0.00000000 0.00000000 0.00000000
[121] 0.00842744 0.00000000 0.00000000 0.00000000 0.00000000 0.00842744

$mids
  [1] 0.0575 0.0625 0.0675 0.0725 0.0775 0.0825 0.0875 0.0925 0.0975 0.1025
 [11] 0.1075 0.1125 0.1175 0.1225 0.1275 0.1325 0.1375 0.1425 0.1475 0.1525
 [21] 0.1575 0.1625 0.1675 0.1725 0.1775 0.1825 0.1875 0.1925 0.1975 0.2025
 [31] 0.2075 0.2125 0.2175 0.2225 0.2275 0.2325 0.2375 0.2425 0.2475 0.2525
 [41] 0.2575 0.2625 0.2675 0.2725 0.2775 0.2825 0.2875 0.2925 0.2975 0.3025
 [51] 0.3075 0.3125 0.3175 0.3225 0.3275 0.3325 0.3375 0.3425 0.3475 0.3525
 [61] 0.3575 0.3625 0.3675 0.3725 0.3775 0.3825 0.3875 0.3925 0.3975 0.4025
 [71] 0.4075 0.4125 0.4175 0.4225 0.4275 0.4325 0.4375 0.4425 0.4475 0.4525
 [81] 0.4575 0.4625 0.4675 0.4725 0.4775 0.4825 0.4875 0.4925 0.4975 0.5025
 [91] 0.5075 0.5125 0.5175 0.5225 0.5275 0.5325 0.5375 0.5425 0.5475 0.5525
[101] 0.5575 0.5625 0.5675 0.5725 0.5775 0.5825 0.5875 0.5925 0.5975 0.6025
[111] 0.6075 0.6125 0.6175 0.6225 0.6275 0.6325 0.6375 0.6425 0.6475 0.6525
[121] 0.6575 0.6625 0.6675 0.6725 0.6775 0.6825

$xname
[1] "srat$nFeature_RNA/srat$nCount_RNA"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">NormalizeData</span>(srat)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">FindVariableFeatures</span>(srat, <span class="at">selection.method =</span> <span class="st">"vst"</span>, <span class="at">nfeatures =</span> <span class="dv">2000</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>top10 <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">VariableFeatures</span>(srat), <span class="dv">15</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">VariableFeaturePlot</span>(srat)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">LabelPoints</span>(<span class="at">plot =</span> plot1, <span class="at">points =</span> top10, <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">xnudge =</span> <span class="dv">0</span>, <span class="at">ynudge =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 28 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: ggrepel: 8 unlabeled data points (too many overlaps). Consider
increasing max.overlaps</code></pre>
</div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>all.genes <span class="ot">&lt;-</span> <span class="fu">rownames</span>(srat)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">ScaleData</span>(srat, <span class="at">features =</span> all.genes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Centering and scaling data matrix</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">RunPCA</span>(srat, <span class="at">features =</span> <span class="fu">VariableFeatures</span>(<span class="at">object =</span> srat),<span class="at">npcs =</span> <span class="dv">75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>PC_ 1 
Positive:  B2M, HLA-A, IFITM1, CD3E, IL32, CD3D, CD7, FYB, CD3G, CD2 
       LCP2, CCL5, CD247, CD96, ITM2A, RARRES3, GIMAP7, HCST, SRGN, CST7 
       ZFP36L2, NKG7, LAT, IL2RB, GZMM, TNFAIP3, S100A4, PRKCH, FYN, HLA-B 
Negative:  RGS13, MEF2B, STMN1, ELL3, CDCA7, POU2AF1, MARCKSL1, KIAA0101, CD79B, NUSAP1 
       TCL1A, TYMS, UBE2J1, RRM2, BASP1, TK1, MKI67, CD79A, SERPINA9, CDT1 
       BIK, BIRC5, NEIL1, LRMP, VPREB3, KIFC1, UBE2C, CCNA2, MS4A1, AICDA 
PC_ 2 
Positive:  CD3E, IL32, CD7, CD3D, CCL5, CD3G, HCST, CD247, NKG7, LCP2 
       CD2, FYB, CD96, CST7, IL2RB, SRGN, GAPDH, RARRES3, FYN, TNFAIP3 
       KLRD1, PRKCH, GZMM, ITM2A, ID2, TMIGD2, GIMAP7, PFN1, CRIP1, LAT 
Negative:  HLA-DQA1, HLA-DRA, HLA-DPB1, CD79A, HLA-DQB1, HLA-DRB1, HLA-DPA1, CD74, MS4A1, VPREB3 
       FCER2, CD83, CD79B, HLA-DRB5, LTB, KLF2, FCRLA, PHACTR1, CR2, IGHM 
       CD40, CD24, TCL1A, GM2A, PLD4, HLA-DQA2, PLAC8, CD180, CTSH, SPIB 
PC_ 3 
Positive:  HOPX, NKG7, CCL5, KLRD1, KIR2DL4, GZMA, GSTP1, FCER1G, MEF2B, MYO1E 
       GAPDH, CD63, ITGA1, GZMB, CST7, SERPINA9, LGALS1, PRF1, RHOC, ACTG1 
       FASLG, RGS13, ID2, CTSW, TMIGD2, SH2D1B, ELL3, CCL4, CLIC3, RUNX3 
Negative:  TCF7, CD4, PDCD1, SPOCK2, PASK, CD28, IL6R, CD5, CCNA2, IL6ST 
       TC2N, UBE2C, TOP2A, TOX2, GPR183, CTLA4, CD6, ACTN1, CCR7, CDCA3 
       GTSE1, KIFC1, LAT, PLK1, AURKB, ICOS, CDCA8, MAF, CDK1, CKAP2L 
PC_ 4 
Positive:  HLA-DRB1, HLA-DPA1, CAPG, HLA-DPB1, FTL, HLA-DRA, HLA-DQA1, CCNA2, FCER2, KIR2DL4 
       CCL5, HOPX, UBE2C, KLRD1, NKG7, VIM, CDCA3, TUBA1B, HLA-DQB1, GTSE1 
       CDCA8, CD63, KIFC1, AURKB, GZMA, TOP2A, DLGAP5, CKAP2L, MKI67, CD74 
Negative:  CD27, PDCD1, PASK, TOX2, MEF2B, CD4, TCF7, LAT, CTLA4, CORO1B 
       MAF, SERPINA9, IL6R, FKBP5, CD28, SH2D1A, ICOS, RGS13, IL6ST, TC2N 
       ISG20, ACTN1, CD6, CD5, SPOCK2, TBC1D4, SMCO4, GNG4, TOX, CD2 
PC_ 5 
Positive:  UHRF1, GINS2, CDC6, CDC45, PKMYT1, MCM4, CDT1, TK1, RRM2, TYMS 
       PCNA, DTL, MCM7, CLSPN, FEN1, E2F1, ASF1B, MCM10, ESCO2, PAQR4 
       DHFR, MCM6, MCM2, HELLS, RAD51, DSCC1, KIAA0101, RAD54L, CHEK1, MCM3 
Negative:  CDC20, PLK1, CCNB2, CENPA, CCNB1, HMMR, DLGAP5, CENPE, KIF20A, AURKA 
       TROAP, CENPF, ASPM, DEPDC1, TPX2, KIF14, CDCA8, FAM72B, NEK2, KNSTRN 
       CDKN3, SGOL2, NUF2, BIRC5, CKAP2L, UBE2C, PIF1, PSRC1, BUB1, CDCA3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(srat, <span class="at">reduction =</span> <span class="st">"pca"</span>,<span class="at">dims =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">group.by =</span> <span class="st">"orig.ident"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(srat, <span class="at">reduction =</span> <span class="st">"pca"</span>,<span class="at">dims =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">group.by =</span> <span class="st">"orig.ident"</span>,<span class="at">split.by =</span> <span class="st">"orig.ident"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ElbowPlot</span>(srat,<span class="at">ndims =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ElbowPlot(srat, ndims = 100): The object only has information for 75
reductions</code></pre>
</div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">RunUMAP</span>(srat, <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>, <span class="at">verbose =</span> F)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(srat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">FindNeighbors</span>(srat, <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Computing nearest neighbor graph</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Computing SNN</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">FindClusters</span>(srat, <span class="at">resolution =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck

Number of nodes: 23732
Number of edges: 835817

Running Louvain algorithm...
Maximum modularity in 10 random starts: 0.9400
Number of communities: 13
Elapsed time: 4 seconds</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(srat,<span class="at">label.size =</span> <span class="dv">4</span>,<span class="at">repel =</span> T,<span class="at">label =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="cell-cycle-score" class="level2">
<h2 class="anchored" data-anchor-id="cell-cycle-score">Cell cycle score</h2>
<p>A list of cell cycle markers, from Tirosh et al, 2015, is loaded with Seurat. We can segregate this list into markers of G2/M phase and markers of S phase</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>s.genes <span class="ot">&lt;-</span> cc.genes.updated<span class="fl">.2019</span><span class="sc">$</span>s.genes</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>s.genes <span class="ot">&lt;-</span> <span class="fu">c</span>(s.genes,<span class="fu">str_to_lower</span>(s.genes))</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>g2m.genes <span class="ot">&lt;-</span> cc.genes.updated<span class="fl">.2019</span><span class="sc">$</span>g2m.genes</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>g2m.genes <span class="ot">&lt;-</span> <span class="fu">c</span>(g2m.genes, <span class="fu">str_to_lower</span>(g2m.genes))</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">CellCycleScoring</span>(srat, <span class="at">s.features =</span> s.genes, <span class="at">g2m.features =</span> g2m.genes, <span class="at">set.ident =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following features are not present in the object: mcm5, pcna,
tyms, fen1, mcm7, mcm4, rrm1, ung, gins2, mcm6, cdca7, dtl, prim1, uhrf1, cenpu,
hells, rfc2, polr1b, nasp, rad51ap1, gmnn, wdr76, slbp, ccne2, ubr7, pold3,
msh2, atad2, rad51, rrm2, cdc45, cdc6, exo1, tipin, dscc1, blm, casp8ap2, usp1,
clspn, pola1, chaf1b, mrpl36, e2f8, not searching for symbol synonyms</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following features are not present in the object: PIMREG, JPT1,
hmgb2, cdk1, nusap1, ube2c, birc5, tpx2, top2a, ndc80, cks2, nuf2, cks1b, mki67,
tmpo, cenpf, tacc3, pimreg, smc4, ccnb2, ckap2l, ckap2, aurkb, bub1, kif11,
anp32e, tubb4b, gtse1, kif20b, hjurp, cdca3, jpt1, cdc20, ttk, cdc25c, kif2c,
rangap1, ncapd2, dlgap5, cdca2, cdca8, ect2, kif23, hmmr, aurka, psrc1, anln,
lbr, ckap5, cenpe, ctcf, nek2, g2e3, gas2l3, cbx5, cenpa, not searching for
symbol synonyms</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># view cell cycle scores and phase assignments</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(srat[[]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       orig.ident nCount_RNA nFeature_RNA percent.mt percent.rb
Col_AAACCTGAGATGCGAC.1          1       4379         1199  3.3340945   45.69536
Col_AAACCTGAGGAATTAC.1          1       4004         1417  0.7742258   37.06294
Col_AAACCTGCAGATGGGT.1          1       5819         1969  2.6980581   34.47328
Col_AAACCTGGTTCGGGCT.1          1       4340         1549  4.0783410   33.66359
Col_AAACCTGGTTTGCATG.1          1       4899         1768  4.4498877   31.72076
Col_AAACCTGTCACATGCA.1          1       3668         1352  3.1352236   36.55943
                       RNA_snn_res.0.3 seurat_clusters     S.Score   G2M.Score
Col_AAACCTGAGATGCGAC.1               3               3 -0.04526088 -0.06738658
Col_AAACCTGAGGAATTAC.1               3               3 -0.06310393 -0.02992080
Col_AAACCTGCAGATGGGT.1               3               3 -0.05474959 -0.06798010
Col_AAACCTGGTTCGGGCT.1               3               3 -0.05709454  0.00728307
Col_AAACCTGGTTTGCATG.1               5               5 -0.10716761 -0.05199952
Col_AAACCTGTCACATGCA.1               3               3  0.01237206 -0.09404912
                       Phase old.ident
Col_AAACCTGAGATGCGAC.1    G1         3
Col_AAACCTGAGGAATTAC.1    G1         3
Col_AAACCTGCAGATGGGT.1    G1         3
Col_AAACCTGGTTCGGGCT.1   G2M         3
Col_AAACCTGGTTTGCATG.1    G1         5
Col_AAACCTGTCACATGCA.1     S         3</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(srat, <span class="at">reduction =</span> <span class="st">"umap"</span>,<span class="at">group.by =</span> <span class="st">"Phase"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">FeaturePlot</span>(srat,<span class="at">features =</span> <span class="fu">c</span>(<span class="st">"S.Score"</span>,<span class="st">"G2M.Score"</span>),<span class="at">label.size =</span> <span class="dv">4</span>,<span class="at">repel =</span> T,<span class="at">label =</span> T) <span class="sc">&amp;</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(srat,<span class="at">features =</span> <span class="fu">c</span>(<span class="st">"S.Score"</span>,<span class="st">"G2M.Score"</span>),<span class="at">group.by  =</span> <span class="st">"seurat_clusters"</span>) <span class="sc">&amp;</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>â€œWe suggest regressing out the difference between the G2M and S phase scores. This means that signals separating non-cycling cells and cycling cells will be maintained, but differences in cell cycle phase amongst proliferating cells (which are often uninteresting), will be regressed out of the dataâ€ From the Seurat official site.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(srat, <span class="at">reduction =</span> <span class="st">"pca"</span>,<span class="at">group.by =</span> <span class="st">"Phase"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#srat$CC.Difference &lt;- srat$S.Score - srat$G2M.Score</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co">#srat &lt;- ScaleData(srat, vars.to.regress = "CC.Difference", features = rownames(srat))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"../data/02_cleaned_data/Seurat_colitis_data.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, a PCA on the variable genes no longer returns components associated with cell cycle</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">RunPCA</span>(srat, <span class="at">features =</span> <span class="fu">VariableFeatures</span>(srat), <span class="at">nfeatures.print =</span> <span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>PC_ 1 
Positive:  B2M, HLA-A, IFITM1, CD3E, IL32, CD3D, CD7, FYB, CD3G, CD2 
       LCP2, CCL5, CD247, CD96, ITM2A, RARRES3, GIMAP7, ZFP36L2, HCST, SRGN 
       CST7, LAT, IL2RB, NKG7, S100A4 
Negative:  RGS13, MEF2B, STMN1, CDCA7, KIAA0101, ELL3, TYMS, RRM2, UBE2C, CDT1 
       TK1, NUSAP1, BIRC5, POU2AF1, MKI67, MARCKSL1, CCNA2, CDKN3, KIFC1, CCNB2 
       UHRF1, UBE2J1, CDCA3, TOP2A, TCL1A 
PC_ 2 
Positive:  HLA-DQA1, HLA-DRA, HLA-DPB1, CD79A, CD74, HLA-DQB1, HLA-DRB1, HLA-DPA1, MS4A1, VPREB3 
       CD79B, CD83, FCER2, HLA-DRB5, LTB, FCRLA, KLF2, CR2, PHACTR1, TCL1A 
       CD40, IGHM, CD24, GM2A, PLD4 
Negative:  CD3E, IL32, CD7, CD3D, CCL5, CD3G, HCST, CD247, NKG7, LCP2 
       CD2, FYB, CD96, CST7, IL2RB, SRGN, RARRES3, GAPDH, FYN, TNFAIP3 
       KLRD1, PRKCH, GZMM, ITM2A, ID2 
PC_ 3 
Positive:  TCF7, CD4, PDCD1, SPOCK2, PASK, IL6R, CD28, CD5, IL6ST, TOX2 
       TC2N, CTLA4, CD6, ACTN1, LAT, ICOS, GPR183, MAF, CCR7, RRM2 
       SH2D1A, GIMAP4, FBLN7, CTSB, TYMS 
Negative:  HOPX, NKG7, CCL5, KLRD1, KIR2DL4, GZMA, FCER1G, GSTP1, CD63, ITGA1 
       GZMB, MYO1E, CST7, LGALS1, PRF1, RHOC, MEF2B, GAPDH, FASLG, CTSW 
       ID2, SH2D1B, TMIGD2, ACTG1, SERPINA9 
PC_ 4 
Positive:  HLA-DRB1, HLA-DPA1, FTL, HLA-DPB1, CAPG, FCER2, HLA-DQA1, HLA-DRA, RRM2, TUBA1B 
       CCNA2, TYMS, HLA-DQB1, KLF2, VIM, CDK1, ASF1B, KIFC1, KIR2DL4, PKMYT1 
       CCL5, UBE2C, KLRD1, CD74, UHRF1 
Negative:  CD27, PDCD1, MEF2B, PASK, SERPINA9, RGS13, TOX2, CD4, TCF7, LAT 
       CTLA4, ISG20, CORO1B, MAF, DCAF12, IL6R, FKBP5, SH2D1A, ELL3, HMCES 
       ICOS, CD28, ACTG1, TOX, IL6ST 
PC_ 5 
Positive:  IL4I1, NFKBIA, KIT, IL23R, NR4A1, TNFRSF18, KRT86, TYROBP, ZFP36, LINC00299 
       CD83, MAP3K8, TNFRSF4, CDKN1A, TNFSF13B, DUSP1, NR4A2, BHLHE40, PHLDA1, AREG 
       BCL2A1, KLF6, KIAA1324, FOS, FOSB 
Negative:  RPL28, GIMAP7, CD8A, GZMM, LEF1, GIMAP4, GIMAP1, CD8B, LINC00861, CD3G 
       CXCR3, CD3D, CCL5, AICDA, NELL2, CD3E, S100A10, RPLP0, FYB, CST7 
       IFNG-AS1, SUSD3, GZMK, CD27, RPLP1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(srat, <span class="at">reduction =</span> <span class="st">"pca"</span>,<span class="at">group.by =</span> <span class="st">"Phase"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            used   (Mb) gc trigger    (Mb)   max used    (Mb)
Ncells   3466120  185.2    5097011   272.3    5097011   272.3
Vcells 779976759 5950.8 1797224541 13711.8 1793215236 13681.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">RunUMAP</span>(srat, <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>, <span class="at">verbose =</span> F)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(srat, <span class="at">reduction =</span> <span class="st">"umap"</span>,<span class="at">group.by =</span> <span class="st">"Phase"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="control-data-set" class="level1">
<h1>Control data set</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>matrix.con <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/01_raw_data/GSE121380_HB1-4_5prime_raw_gene_expression.txt.gz"</span>,<span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(matrix.con) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"CTRL_"</span>,<span class="fu">colnames</span>(matrix.con))</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">CreateSeuratObject</span>(matrix.con,<span class="at">project =</span> <span class="st">"RNA editing"</span>,<span class="at">names.field =</span> <span class="dv">2</span>,<span class="at">names.delim =</span> <span class="st">"[.]"</span>,<span class="at">min.cells =</span> <span class="dv">3</span>, <span class="at">min.features =</span> <span class="dv">200</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Feature names cannot have underscores ('_'), replacing with dashes
('-')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>srat[[<span class="st">"percent.mt"</span>]] <span class="ot">&lt;-</span> <span class="fu">PercentageFeatureSet</span>(srat, <span class="at">pattern =</span> <span class="st">"^MT-"</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>srat[[<span class="st">"percent.rb"</span>]] <span class="ot">&lt;-</span> <span class="fu">PercentageFeatureSet</span>(srat, <span class="at">pattern =</span> <span class="st">"^RP[SL]"</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(srat, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"nFeature_RNA"</span>,<span class="st">"nCount_RNA"</span>,<span class="st">"percent.rb"</span>,<span class="st">"percent.mt"</span>),<span class="at">ncol =</span> <span class="dv">2</span>,<span class="at">pt.size =</span> <span class="fl">0.1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">subset</span>(srat, <span class="at">subset =</span> nFeature_RNA <span class="sc">&gt;</span> <span class="dv">200</span> <span class="sc">&amp;</span> nFeature_RNA <span class="sc">&lt;</span> <span class="dv">4000</span> <span class="sc">&amp;</span> percent.mt <span class="sc">&lt;</span> <span class="dv">15</span> <span class="sc">&amp;</span>  nCount_RNA <span class="sc">&lt;</span> <span class="dv">30000</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(srat, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"nFeature_RNA"</span>,<span class="st">"nCount_RNA"</span>,<span class="st">"percent.rb"</span>,<span class="st">"percent.mt"</span>),<span class="at">ncol =</span> <span class="dv">2</span>,<span class="at">pt.size =</span> <span class="fl">0.1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">FeatureScatter</span>(srat, <span class="at">feature1 =</span> <span class="st">"nCount_RNA"</span>, <span class="at">feature2 =</span> <span class="st">"nFeature_RNA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">FeatureScatter</span>(srat, <span class="at">feature1 =</span> <span class="st">"nCount_RNA"</span>, <span class="at">feature2 =</span> <span class="st">"percent.mt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">hist</span>(srat<span class="sc">$</span>nFeature_RNA<span class="sc">/</span>srat<span class="sc">$</span>nCount_RNA, <span class="at">breaks =</span> <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
  [1] 0.030 0.035 0.040 0.045 0.050 0.055 0.060 0.065 0.070 0.075 0.080 0.085
 [13] 0.090 0.095 0.100 0.105 0.110 0.115 0.120 0.125 0.130 0.135 0.140 0.145
 [25] 0.150 0.155 0.160 0.165 0.170 0.175 0.180 0.185 0.190 0.195 0.200 0.205
 [37] 0.210 0.215 0.220 0.225 0.230 0.235 0.240 0.245 0.250 0.255 0.260 0.265
 [49] 0.270 0.275 0.280 0.285 0.290 0.295 0.300 0.305 0.310 0.315 0.320 0.325
 [61] 0.330 0.335 0.340 0.345 0.350 0.355 0.360 0.365 0.370 0.375 0.380 0.385
 [73] 0.390 0.395 0.400 0.405 0.410 0.415 0.420 0.425 0.430 0.435 0.440 0.445
 [85] 0.450 0.455 0.460 0.465 0.470 0.475 0.480 0.485 0.490 0.495 0.500 0.505
 [97] 0.510 0.515 0.520 0.525 0.530 0.535 0.540 0.545 0.550 0.555 0.560 0.565
[109] 0.570 0.575 0.580 0.585 0.590 0.595 0.600 0.605 0.610 0.615 0.620 0.625
[121] 0.630 0.635

$counts
  [1]   1   1   2   1  14  38  81 121 165 182 188 210 201 175 172 164 164 164
 [19] 136 153 117 112 110  94  89  84  98  70  93  78  79  66  55  78  73  73
 [37]  71  77  94 112  84  95 121 113 140 149 152 137 151 202 232 265 275 279
 [55] 291 323 354 321 332 372 358 355 360 333 329 314 291 305 264 249 213 226
 [73] 167 187 158 156 113 122  75  71  74  43  43  42  23  22  26  15  15  10
 [91]   3   6   6   4   2   3   1   1   1   2   0   1   0   0   0   0   2   0
[109]   0   0   0   0   0   0   1   0   0   0   0   0   1

$density
  [1] 0.01488427 0.01488427 0.02976855 0.01488427 0.20837985 0.56560244
  [7] 1.20562626 1.80099725 2.45590534 2.70893801 2.79824366 3.12569770
 [13] 2.99173923 2.60474808 2.56009526 2.44102106 2.44102106 2.44102106
 [19] 2.02426137 2.27729404 1.74146015 1.66703877 1.63727022 1.39912183
 [25] 1.32470045 1.25027908 1.45865893 1.04189923 1.38423755 1.16097343
 [31] 1.17585771 0.98236213 0.81863511 1.16097343 1.08655206 1.08655206
 [37] 1.05678351 1.14608916 1.39912183 1.66703877 1.25027908 1.41400610
 [43] 1.80099725 1.68192305 2.08379847 2.21775694 2.26240976 2.03914564
 [49] 2.24752549 3.00662350 3.45315175 3.94433281 4.09317556 4.15271266
 [55] 4.33132396 4.80762075 5.26903327 4.77785220 4.94157922 5.53695021
 [61] 5.32857037 5.28391754 5.35833891 4.95646350 4.89692640 4.67366228
 [67] 4.33132396 4.53970380 3.92944854 3.70618442 3.17035052 3.36384610
 [73] 2.48567389 2.78335938 2.35171541 2.32194686 1.68192305 1.81588152
 [79] 1.11632061 1.05678351 1.10143633 0.64002381 0.64002381 0.62513954
 [85] 0.34233832 0.32745404 0.38699114 0.22326412 0.22326412 0.14884275
 [91] 0.04465282 0.08930565 0.08930565 0.05953710 0.02976855 0.04465282
 [97] 0.01488427 0.01488427 0.01488427 0.02976855 0.00000000 0.01488427
[103] 0.00000000 0.00000000 0.00000000 0.00000000 0.02976855 0.00000000
[109] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[115] 0.01488427 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[121] 0.01488427

$mids
  [1] 0.0325 0.0375 0.0425 0.0475 0.0525 0.0575 0.0625 0.0675 0.0725 0.0775
 [11] 0.0825 0.0875 0.0925 0.0975 0.1025 0.1075 0.1125 0.1175 0.1225 0.1275
 [21] 0.1325 0.1375 0.1425 0.1475 0.1525 0.1575 0.1625 0.1675 0.1725 0.1775
 [31] 0.1825 0.1875 0.1925 0.1975 0.2025 0.2075 0.2125 0.2175 0.2225 0.2275
 [41] 0.2325 0.2375 0.2425 0.2475 0.2525 0.2575 0.2625 0.2675 0.2725 0.2775
 [51] 0.2825 0.2875 0.2925 0.2975 0.3025 0.3075 0.3125 0.3175 0.3225 0.3275
 [61] 0.3325 0.3375 0.3425 0.3475 0.3525 0.3575 0.3625 0.3675 0.3725 0.3775
 [71] 0.3825 0.3875 0.3925 0.3975 0.4025 0.4075 0.4125 0.4175 0.4225 0.4275
 [81] 0.4325 0.4375 0.4425 0.4475 0.4525 0.4575 0.4625 0.4675 0.4725 0.4775
 [91] 0.4825 0.4875 0.4925 0.4975 0.5025 0.5075 0.5125 0.5175 0.5225 0.5275
[101] 0.5325 0.5375 0.5425 0.5475 0.5525 0.5575 0.5625 0.5675 0.5725 0.5775
[111] 0.5825 0.5875 0.5925 0.5975 0.6025 0.6075 0.6125 0.6175 0.6225 0.6275
[121] 0.6325

$xname
[1] "srat$nFeature_RNA/srat$nCount_RNA"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">NormalizeData</span>(srat)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">FindVariableFeatures</span>(srat, <span class="at">selection.method =</span> <span class="st">"vst"</span>, <span class="at">nfeatures =</span> <span class="dv">2000</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>top10 <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">VariableFeatures</span>(srat), <span class="dv">15</span>)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">VariableFeaturePlot</span>(srat)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">LabelPoints</span>(<span class="at">plot =</span> plot1, <span class="at">points =</span> top10, <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">xnudge =</span> <span class="dv">0</span>, <span class="at">ynudge =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 150 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: ggrepel: 11 unlabeled data points (too many overlaps). Consider
increasing max.overlaps</code></pre>
</div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>all.genes <span class="ot">&lt;-</span> <span class="fu">rownames</span>(srat)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">ScaleData</span>(srat, <span class="at">features =</span> all.genes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Centering and scaling data matrix</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">RunPCA</span>(srat, <span class="at">features =</span> <span class="fu">VariableFeatures</span>(<span class="at">object =</span> srat),<span class="at">npcs =</span> <span class="dv">75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>PC_ 1 
Positive:  VPREB3, MS4A1, HMGA1, TCL1A, BCAS4, LRMP, FCRLA, MEF2B, ODC1, RGS13 
       MZB1, ELL3, CD22, IGLL5, BACH2, DCK, PTTG1, CDCA7, CENPM, SEC11C 
       GCSAM, KIAA0101, GCHFR, BIK, NUSAP1, COTL1, KIAA0922, RRM2, TYMS, CR2 
Negative:  COL3A1, C1S, COL1A2, CALD1, A2M, CXCL14, MFAP4, IGFBP7, COL1A1, SOD3 
       SPARC, FBLN1, RARRES2, DCN, COL6A2, COL6A1, LUM, ADAMDEC1, RBP1, APOE 
       MMP2, TMEM176A, TMEM176B, SERPING1, CTSK, SPARCL1, CXCL12, CFD, CFH, PROCR 
PC_ 2 
Positive:  STMN1, HMGB2, NUSAP1, UBE2C, KIAA0101, BIRC5, TYMS, CCNA2, RRM2, TOP2A 
       CDCA3, CDK1, MKI67, CDKN3, KIFC1, TK1, HMGN2, CENPM, CDCA7, PTTG1 
       TPX2, CENPF, HMGB1, AURKB, TUBB, CDT1, CDCA8, CCNB2, GTSE1, RGS13 
Negative:  FKBP11, HSP90B1, XBP1, DERL3, ITM2C, PRDX4, SRGN, IGHA2, RP11-290F5.1, IGKC 
       SDC1, HSPA1B, SEC11C, FYB, S100A4, MYDGF, IRF4, CD7, ZBP1, CCR10 
       RRBP1, AQP3, TXNDC5, SPAG4, IL32, CD3D, GIMAP7, PRDM1, MANF, TNFAIP3 
PC_ 3 
Positive:  LYZ, IGSF6, AIF1, CPVL, SERPINA1, FGL2, MS4A6A, TYROBP, MNDA, CLEC10A 
       CST3, LGALS2, CSF1R, IL1B, HCK, CD68, CFP, LST1, PILRA, LILRB2 
       CSTA, CLEC7A, FCN1, FCER1G, CD14, CSF3R, CXCL8, CCL3L3, CLEC4A, IER3 
Negative:  MZB1, FKBP11, DERL3, TNFRSF17, SELM, IGLL5, SEC11C, IGKC, IGHA2, RP11-290F5.1 
       PRDX4, XBP1, SDC1, TXNDC5, RRBP1, CCR10, SPAG4, ERLEC1, TXNDC11, ZBP1 
       UAP1, HSP90B1, MDK, ITM2C, COL1A2, COL3A1, PIM2, LMAN1, MANF, MFAP4 
PC_ 4 
Positive:  IL32, CD7, CD3D, CD2, CD3G, CD247, CD96, FYB, CCL5, GIMAP7 
       LAT, GZMM, IL2RB, CST7, IL7R, NKG7, GIMAP4, ITM2A, SCML4, SIRPG 
       TNFAIP3, TCF7, ID2, SPOCK2, TMIGD2, CD6, KLRD1, S100A4, CD8A, MATK 
Negative:  HERPUD1, MZB1, DERL3, IGLL5, TNFRSF17, IGKC, PRDX4, SEC11C, IGHA2, RP11-290F5.1 
       RRBP1, XBP1, TXNDC5, HLA-DQA1, SDC1, FKBP11, HLA-DPA1, CCR10, HLA-DQB1, HLA-DRA 
       VPREB3, NPC2, SPI1, SPAG4, HSP90B1, IRF4, MS4A1, CTSH, HLA-DRB1, MYDGF 
PC_ 5 
Positive:  LGALS4, PHGR1, TSPAN8, FABP1, KRT8, C10orf99, SMIM22, FXYD3, ELF3, C19orf33 
       KRT18, S100A14, C15orf48, KLF5, EPCAM, PIGR, GPX2, KRT19, TMEM54, MT1G 
       CLDN7, CLDN3, PRR15L, CLDN4, FAM3D, PRSS3, CHP2, STAP2, CDX2, CA2 
Negative:  COTL1, CD3D, CD7, FYB, CD3G, HLA-DPB1, CD2, CD247, MS4A1, ITGB2 
       HLA-DQB1, LAT, HLA-DQA1, CTSC, CD96, CD83, SPOCK2, HLA-DPA1, GIMAP7, SELL 
       HLA-DRA, GZMM, CCL5, IL32, HLA-DRB1, S100A4, NR4A2, GIMAP4, TUBA1A, IL7R </code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(srat, <span class="at">reduction =</span> <span class="st">"pca"</span>,<span class="at">dims =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">group.by =</span> <span class="st">"orig.ident"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(srat, <span class="at">reduction =</span> <span class="st">"pca"</span>,<span class="at">dims =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">group.by =</span> <span class="st">"orig.ident"</span>,<span class="at">split.by =</span> <span class="st">"orig.ident"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ElbowPlot</span>(srat,<span class="at">ndims =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ElbowPlot(srat, ndims = 100): The object only has information for 75
reductions</code></pre>
</div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">RunUMAP</span>(srat, <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>, <span class="at">verbose =</span> F)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(srat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">FindNeighbors</span>(srat, <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Computing nearest neighbor graph</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Computing SNN</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>srat <span class="ot">&lt;-</span> <span class="fu">FindClusters</span>(srat, <span class="at">resolution =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck

Number of nodes: 13437
Number of edges: 508861

Running Louvain algorithm...
Maximum modularity in 10 random starts: 0.9532
Number of communities: 16
Elapsed time: 1 seconds</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(srat,<span class="at">label.size =</span> <span class="dv">4</span>,<span class="at">repel =</span> T,<span class="at">label =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01A_Seurat_import_clean_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">#saveRDS(srat,"../Seurat_control_data.RDS")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>