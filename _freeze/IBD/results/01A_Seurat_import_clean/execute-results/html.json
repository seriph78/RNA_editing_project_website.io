{
  "hash": "a00c2fa031b8fe6f63e211e8af9569eb",
  "result": {
    "markdown": "---\ntitle: \"IBD pooled dataset cleaning\"\ntoc: true\n\nexecute: \n  freeze: true\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(stringr)\nlibrary(Seurat)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nAttaching SeuratObject\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nAttaching sp\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(RColorBrewer)\n```\n:::\n\n\n# Colitis data set\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmatrix.col <- read.csv(\"../data/01_raw_data/GSE121380_Col1-6_5prime_raw_gene_expression.txt.gz\",sep = \"\\t\",row.names = 1)\ncolnames(matrix.col) <- paste0(\"Col_\",colnames(matrix.col))\n\nsrat <- CreateSeuratObject(matrix.col,project = \"RNA editing\",names.field = 2,names.delim = \"[.]\",min.cells = 3, min.features = 200) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')\n```\n:::\n\n```{.r .cell-code}\nsrat[[\"percent.mt\"]] <- PercentageFeatureSet(srat, pattern = \"^MT-\")\nsrat[[\"percent.rb\"]] <- PercentageFeatureSet(srat, pattern = \"^RP[SL]\")\n\nVlnPlot(srat, features = c(\"nFeature_RNA\",\"nCount_RNA\",\"percent.rb\",\"percent.mt\"),ncol = 2,pt.size = 0.1) \n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nIn the original paper, there aren't the cleaning parameters! Notice also that sample number 4, and, to some extent, also the number 5, are quite different: quite fewer RNA molecules detected, lower number of genes detected, and lower ribosomal genes but higher mitochondrial RNA.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsrat <- subset(srat, subset = nFeature_RNA > 200 & nFeature_RNA < 4000 & percent.mt < 15 &  nCount_RNA < 20000)\n\nVlnPlot(srat, features = c(\"nFeature_RNA\",\"nCount_RNA\",\"percent.rb\",\"percent.mt\"),ncol = 2,pt.size = 0.1) \n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nFeatureScatter(srat, feature1 = \"nCount_RNA\", feature2 = \"nFeature_RNA\")\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nFeatureScatter(srat, feature1 = \"nCount_RNA\", feature2 = \"percent.mt\")\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(hist(srat$nFeature_RNA/srat$nCount_RNA, breaks = 100))\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n$breaks\n [1] 0.05 0.06 0.07 0.08 0.09 0.10 0.11 0.12 0.13 0.14 0.15 0.16 0.17 0.18 0.19\n[16] 0.20 0.21 0.22 0.23 0.24 0.25 0.26 0.27 0.28 0.29 0.30 0.31 0.32 0.33 0.34\n[31] 0.35 0.36 0.37 0.38 0.39 0.40 0.41 0.42 0.43 0.44 0.45 0.46 0.47 0.48 0.49\n[46] 0.50 0.51 0.52 0.53 0.54 0.55 0.56 0.57 0.58 0.59 0.60 0.61 0.62 0.63 0.64\n[61] 0.65 0.66 0.67 0.68 0.69 0.70 0.71 0.72 0.73 0.74 0.75 0.76 0.77 0.78 0.79\n\n$counts\n [1]    2    3    4    5    9    5    8   14   10   11    7   15   18   14   18\n[16]   39   48   72   96  147  199  291  393  529  648  833  942 1176 1322 1506\n[31] 1602 1743 1754 1674 1666 1474 1218 1023  863  683  563  431  353  266  200\n[46]  131  127   80   66   58   50   29   35   34   21   16   21   23   16    5\n[61]   10    9    8    3    2    3    3    3    3    4    1    2    2    1\n\n$density\n [1] 0.008109314 0.012163970 0.016218627 0.020273284 0.036491911 0.020273284\n [7] 0.032437254 0.056765195 0.040546568 0.044601225 0.028382597 0.060819852\n[13] 0.072983822 0.056765195 0.072983822 0.158131614 0.194623525 0.291935288\n[19] 0.389247050 0.596034546 0.806876698 1.179905121 1.593480112 2.144913433\n[25] 2.627417589 3.377529092 3.819486680 4.768276365 5.360256254 6.106313101\n[31] 6.495560151 7.067266756 7.111867980 6.787495439 6.755058184 5.976564084\n[37] 4.938571950 4.147913879 3.499168795 2.769330576 2.282771763 1.747557069\n[43] 1.431293841 1.078538702 0.810931355 0.531160037 0.514941410 0.324372542\n[49] 0.267607347 0.235170093 0.202732839 0.117585046 0.141912987 0.137858330\n[55] 0.085147792 0.064874508 0.085147792 0.093257106 0.064874508 0.020273284\n[61] 0.040546568 0.036491911 0.032437254 0.012163970 0.008109314 0.012163970\n[67] 0.012163970 0.012163970 0.012163970 0.016218627 0.004054657 0.008109314\n[73] 0.008109314 0.004054657\n\n$mids\n [1] 0.055 0.065 0.075 0.085 0.095 0.105 0.115 0.125 0.135 0.145 0.155 0.165\n[13] 0.175 0.185 0.195 0.205 0.215 0.225 0.235 0.245 0.255 0.265 0.275 0.285\n[25] 0.295 0.305 0.315 0.325 0.335 0.345 0.355 0.365 0.375 0.385 0.395 0.405\n[37] 0.415 0.425 0.435 0.445 0.455 0.465 0.475 0.485 0.495 0.505 0.515 0.525\n[49] 0.535 0.545 0.555 0.565 0.575 0.585 0.595 0.605 0.615 0.625 0.635 0.645\n[61] 0.655 0.665 0.675 0.685 0.695 0.705 0.715 0.725 0.735 0.745 0.755 0.765\n[73] 0.775 0.785\n\n$xname\n[1] \"srat$nFeature_RNA/srat$nCount_RNA\"\n\n$equidist\n[1] TRUE\n\nattr(,\"class\")\n[1] \"histogram\"\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsrat <- NormalizeData(srat)\nsrat <- FindVariableFeatures(srat, selection.method = \"vst\", nfeatures = 2000)\ntop10 <- head(VariableFeatures(srat), 15)\nplot1 <- VariableFeaturePlot(srat)\nLabelPoints(plot = plot1, points = top10, repel = TRUE, xnudge = 0, ynudge = 0)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Transformation introduced infinite values in continuous x-axis\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 13 rows containing missing values (geom_point).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: ggrepel: 9 unlabeled data points (too many overlaps). Consider\nincreasing max.overlaps\n```\n:::\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nall.genes <- rownames(srat)\nsrat <- ScaleData(srat, features = all.genes)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCentering and scaling data matrix\n```\n:::\n\n```{.r .cell-code}\nsrat <- RunPCA(srat, features = VariableFeatures(object = srat),npcs = 75)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nPC_ 1 \nPositive:  RGS13, STMN1, MEF2B, TYMS, RRM2, NUSAP1, KIAA0101, CDCA7, TK1, MKI67 \n\t   KIFC1, CCNA2, BIRC5, UBE2C, CDT1, CDK1, CDKN3, ELL3, TOP2A, CENPM \n\t   CDCA3, HMGB2, MND1, POU2AF1, TPX2, UBE2J1, DHFR, UHRF1, MYBL2, HMGN2 \nNegative:  B2M, IFITM1, IL32, CD3E, CD3D, CD7, FYB, CD3G, CD2, CCL5 \n\t   CD96, CD247, RARRES3, ITM2A, GIMAP7, CST7, SRGN, NKG7, HLA-B, IL2RB \n\t   LAT, S100A6, TNFAIP3, S100A4, GZMM, CD69, NR4A2, PRKCH, FYN, GIMAP4 \nPC_ 2 \nPositive:  PHGR1, LGALS4, FABP1, KRT8, IFI27, C19orf33, FXYD3, C15orf48, CA2, SMIM22 \n\t   TMEM54, PKIB, SLC26A3, ANPEP, KRT18, LGALS3, TSPAN8, SDCBP2, EPCAM, PRSS3 \n\t   CEACAM7, AQP8, SFN, PIGR, KRT20, ELF3, CKB, TST, CLDN7, SEPP1 \nNegative:  EEF1A1, RPLP1, RPL28, MT-CO2, RPLP0, B2M, ACTB, PTMA, MALAT1, CD3E \n\t   CD3D, CD69, CD7, IFITM1, PPIA, VIM, CD3G, CD2, CCL5, SRGN \n\t   ZFP36, CD247, CD96, PFN1, ITM2A, CD74, NR4A2, HLA-B, RGS1, FYN \nPC_ 3 \nPositive:  IL32, CD3E, CD7, CD3D, CCL5, CD3G, NKG7, CD247, CST7, CD96 \n\t   CD2, IL2RB, RARRES3, FYB, SRGN, KLRD1, TNFAIP3, FYN, PRKCH, GZMM \n\t   TMIGD2, ID2, IFITM1, ITM2A, HOPX, SH2D2A, GIMAP7, CD8A, CTSW, LAT \nNegative:  HLA-DRA, CD79A, HLA-DQA1, MS4A1, CD74, HLA-DRB1, VPREB3, CD83, FCER2, LTB \n\t   HLA-DRB5, TCL1A, CD40, CR2, IGHM, PHACTR1, KLF2, CTSH, BASP1, CD24 \n\t   SPIB, HERPUD1, PLD4, IRF8, AC079767.4, HLA-DQA2, SCIMP, EAF2, GRN, KIAA0226L \nPC_ 4 \nPositive:  TCF7, CD4, SPOCK2, PDCD1, PASK, CD28, CD5, IL6R, IL6ST, TC2N \n\t   GPR183, CD6, CTLA4, TOX2, CCR7, CCNA2, UBE2C, ACTN1, PLK1, TOP2A \n\t   LAT, CDCA3, ICOS, GTSE1, MAF, DLGAP5, AURKB, CDCA8, CENPA, CKAP2L \nNegative:  HOPX, NKG7, CCL5, KLRD1, KIR2DL4, MEF2B, GSTP1, GZMA, GAPDH, SERPINA9 \n\t   MYO1E, FCER1G, RGS13, GZMB, ITGA1, CD63, ACTG1, LGALS1, CST7, ELL3 \n\t   PRF1, FASLG, TPI1, RHOC, CTSW, SH2D1B, TMIGD2, CCL4, SERF2, CLIC3 \nPC_ 5 \nPositive:  HLA-DRB1, HLA-DQA1, HLA-DRA, FTL, FCER2, PLK1, CENPA, DLGAP5, KIR2DL4, UBE2C \n\t   CD74, KLF2, HOPX, CDC20, VIM, CCNA2, CCL5, KLRD1, CDCA3, NKG7 \n\t   CDCA8, GTSE1, CKAP2L, AURKB, HMMR, CD63, CCNB2, ASPM, GZMA, TOP2A \nNegative:  PDCD1, PASK, TOX2, CD4, TCF7, LAT, CTLA4, MEF2B, CORO1B, FKBP5 \n\t   MAF, IL6R, SH2D1A, CD28, ICOS, IL6ST, SERPINA9, TC2N, CD6, SMCO4 \n\t   CD5, RGS13, SPOCK2, CD2, GNG4, ISG20, TBC1D4, ITM2A, ACTN1, MAGEH1 \n```\n:::\n\n```{.r .cell-code}\nDimPlot(srat, reduction = \"pca\",dims = c(1,2),group.by = \"orig.ident\")\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nDimPlot(srat, reduction = \"pca\",dims = c(1,2),group.by = \"orig.ident\",split.by = \"orig.ident\")\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nElbowPlot(srat,ndims = 100)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in ElbowPlot(srat, ndims = 100): The object only has information for 75\nreductions\n```\n:::\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsrat <- RunUMAP(srat, dims = 1:25, verbose = F)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric\nTo use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation'\nThis message will be shown once per session\n```\n:::\n\n```{.r .cell-code}\nDimPlot(srat)\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nSo we decided to drop cell set number 4 and 5.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsrat <- CreateSeuratObject(matrix.col[,str_ends(colnames(matrix.col),pattern = \"[4-5]\",negate = T)],project = \"RNA editing\",names.field = 2,names.delim = \"[.]\",min.cells = 3, min.features = 200) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')\n```\n:::\n\n```{.r .cell-code}\nsrat[[\"percent.mt\"]] <- PercentageFeatureSet(srat, pattern = \"^MT-\")\nsrat[[\"percent.rb\"]] <- PercentageFeatureSet(srat, pattern = \"^RP\")\n\nVlnPlot(srat, features = c(\"nFeature_RNA\",\"nCount_RNA\",\"percent.rb\",\"percent.mt\"),ncol = 2,pt.size = 0.1) \n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsrat <- subset(srat, subset = nFeature_RNA > 200 & nFeature_RNA < 4000 & percent.mt < 12 &  nCount_RNA < 15000)\n\nVlnPlot(srat, features = c(\"nFeature_RNA\",\"nCount_RNA\",\"percent.rb\",\"percent.mt\"),ncol = 2,pt.size = 0.1) \n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nFeatureScatter(srat, feature1 = \"nCount_RNA\", feature2 = \"nFeature_RNA\")\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nFeatureScatter(srat, feature1 = \"nCount_RNA\", feature2 = \"percent.mt\")\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(hist(srat$nFeature_RNA/srat$nCount_RNA, breaks = 100))\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n$breaks\n  [1] 0.055 0.060 0.065 0.070 0.075 0.080 0.085 0.090 0.095 0.100 0.105 0.110\n [13] 0.115 0.120 0.125 0.130 0.135 0.140 0.145 0.150 0.155 0.160 0.165 0.170\n [25] 0.175 0.180 0.185 0.190 0.195 0.200 0.205 0.210 0.215 0.220 0.225 0.230\n [37] 0.235 0.240 0.245 0.250 0.255 0.260 0.265 0.270 0.275 0.280 0.285 0.290\n [49] 0.295 0.300 0.305 0.310 0.315 0.320 0.325 0.330 0.335 0.340 0.345 0.350\n [61] 0.355 0.360 0.365 0.370 0.375 0.380 0.385 0.390 0.395 0.400 0.405 0.410\n [73] 0.415 0.420 0.425 0.430 0.435 0.440 0.445 0.450 0.455 0.460 0.465 0.470\n [85] 0.475 0.480 0.485 0.490 0.495 0.500 0.505 0.510 0.515 0.520 0.525 0.530\n [97] 0.535 0.540 0.545 0.550 0.555 0.560 0.565 0.570 0.575 0.580 0.585 0.590\n[109] 0.595 0.600 0.605 0.610 0.615 0.620 0.625 0.630 0.635 0.640 0.645 0.650\n[121] 0.655 0.660 0.665 0.670 0.675 0.680 0.685\n\n$counts\n  [1]   1   0   1   0   1   0   0   1   4   2   2   2   3   2   3   2   3   6\n [19]   2   3   2   7   6   3   7   0   7   5   9   7  10   7  14  22  23  32\n [37]  43  50  82  90  99 127 160 195 192 250 270 309 331 401 426 438 487 574\n [55] 590 605 699 745 741 758 824 835 874 874 856 831 808 850 792 750 705 637\n [73] 548 533 465 460 380 347 315 288 254 228 191 167 166 130 110  91  88  66\n [91]  46  59  49  41  28  32  21  19  16  12  16   9   9   8   7   8   3   4\n[109]   2   5   0   2   3   2   3   1   1   0   0   0   1   0   0   0   0   1\n\n$density\n  [1] 0.00842744 0.00000000 0.00842744 0.00000000 0.00842744 0.00000000\n  [7] 0.00000000 0.00842744 0.03370976 0.01685488 0.01685488 0.01685488\n [13] 0.02528232 0.01685488 0.02528232 0.01685488 0.02528232 0.05056464\n [19] 0.01685488 0.02528232 0.01685488 0.05899208 0.05056464 0.02528232\n [25] 0.05899208 0.00000000 0.05899208 0.04213720 0.07584696 0.05899208\n [31] 0.08427440 0.05899208 0.11798416 0.18540367 0.19383111 0.26967807\n [37] 0.36237991 0.42137199 0.69105006 0.75846958 0.83431653 1.07028485\n [43] 1.34839036 1.64335075 1.61806843 2.10685994 2.27540873 2.60407888\n [49] 2.78948256 3.37940334 3.59008933 3.69121861 4.10416316 4.83735041\n [55] 4.97218945 5.09860105 5.89078038 6.27844261 6.24473285 6.38799933\n [61] 6.94421035 7.03691219 7.36558234 7.36558234 7.21388842 7.00320243\n [67] 6.80937131 7.16332378 6.67453228 6.32057981 5.94134502 5.36827912\n [73] 4.61823698 4.49182538 3.91875948 3.87662228 3.20242710 2.92432159\n [79] 2.65464352 2.42710265 2.14056969 1.92145626 1.60964099 1.40738244\n [85] 1.39895500 1.09556717 0.92701837 0.76689702 0.74161470 0.55621102\n [91] 0.38766223 0.49721894 0.41294455 0.34552503 0.23596831 0.26967807\n [97] 0.17697623 0.16012136 0.13483904 0.10112928 0.13483904 0.07584696\n[103] 0.07584696 0.06741952 0.05899208 0.06741952 0.02528232 0.03370976\n[109] 0.01685488 0.04213720 0.00000000 0.01685488 0.02528232 0.01685488\n[115] 0.02528232 0.00842744 0.00842744 0.00000000 0.00000000 0.00000000\n[121] 0.00842744 0.00000000 0.00000000 0.00000000 0.00000000 0.00842744\n\n$mids\n  [1] 0.0575 0.0625 0.0675 0.0725 0.0775 0.0825 0.0875 0.0925 0.0975 0.1025\n [11] 0.1075 0.1125 0.1175 0.1225 0.1275 0.1325 0.1375 0.1425 0.1475 0.1525\n [21] 0.1575 0.1625 0.1675 0.1725 0.1775 0.1825 0.1875 0.1925 0.1975 0.2025\n [31] 0.2075 0.2125 0.2175 0.2225 0.2275 0.2325 0.2375 0.2425 0.2475 0.2525\n [41] 0.2575 0.2625 0.2675 0.2725 0.2775 0.2825 0.2875 0.2925 0.2975 0.3025\n [51] 0.3075 0.3125 0.3175 0.3225 0.3275 0.3325 0.3375 0.3425 0.3475 0.3525\n [61] 0.3575 0.3625 0.3675 0.3725 0.3775 0.3825 0.3875 0.3925 0.3975 0.4025\n [71] 0.4075 0.4125 0.4175 0.4225 0.4275 0.4325 0.4375 0.4425 0.4475 0.4525\n [81] 0.4575 0.4625 0.4675 0.4725 0.4775 0.4825 0.4875 0.4925 0.4975 0.5025\n [91] 0.5075 0.5125 0.5175 0.5225 0.5275 0.5325 0.5375 0.5425 0.5475 0.5525\n[101] 0.5575 0.5625 0.5675 0.5725 0.5775 0.5825 0.5875 0.5925 0.5975 0.6025\n[111] 0.6075 0.6125 0.6175 0.6225 0.6275 0.6325 0.6375 0.6425 0.6475 0.6525\n[121] 0.6575 0.6625 0.6675 0.6725 0.6775 0.6825\n\n$xname\n[1] \"srat$nFeature_RNA/srat$nCount_RNA\"\n\n$equidist\n[1] TRUE\n\nattr(,\"class\")\n[1] \"histogram\"\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsrat <- NormalizeData(srat)\nsrat <- FindVariableFeatures(srat, selection.method = \"vst\", nfeatures = 2000)\ntop10 <- head(VariableFeatures(srat), 15)\nplot1 <- VariableFeaturePlot(srat)\nLabelPoints(plot = plot1, points = top10, repel = TRUE, xnudge = 0, ynudge = 0)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Transformation introduced infinite values in continuous x-axis\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 28 rows containing missing values (geom_point).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: ggrepel: 8 unlabeled data points (too many overlaps). Consider\nincreasing max.overlaps\n```\n:::\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nall.genes <- rownames(srat)\nsrat <- ScaleData(srat, features = all.genes)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCentering and scaling data matrix\n```\n:::\n\n```{.r .cell-code}\nsrat <- RunPCA(srat, features = VariableFeatures(object = srat),npcs = 75)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nPC_ 1 \nPositive:  B2M, HLA-A, IFITM1, CD3E, IL32, CD3D, CD7, FYB, CD3G, CD2 \n\t   LCP2, CCL5, CD247, CD96, ITM2A, RARRES3, GIMAP7, HCST, SRGN, CST7 \n\t   ZFP36L2, NKG7, LAT, IL2RB, GZMM, TNFAIP3, S100A4, PRKCH, FYN, HLA-B \nNegative:  RGS13, MEF2B, STMN1, ELL3, CDCA7, POU2AF1, MARCKSL1, KIAA0101, CD79B, NUSAP1 \n\t   TCL1A, TYMS, UBE2J1, RRM2, BASP1, TK1, MKI67, CD79A, SERPINA9, CDT1 \n\t   BIK, BIRC5, NEIL1, LRMP, VPREB3, KIFC1, UBE2C, CCNA2, MS4A1, AICDA \nPC_ 2 \nPositive:  CD3E, IL32, CD7, CD3D, CCL5, CD3G, HCST, CD247, NKG7, LCP2 \n\t   CD2, FYB, CD96, CST7, IL2RB, SRGN, GAPDH, RARRES3, FYN, TNFAIP3 \n\t   KLRD1, PRKCH, GZMM, ITM2A, ID2, TMIGD2, GIMAP7, PFN1, CRIP1, LAT \nNegative:  HLA-DQA1, HLA-DRA, HLA-DPB1, CD79A, HLA-DQB1, HLA-DRB1, HLA-DPA1, CD74, MS4A1, VPREB3 \n\t   FCER2, CD83, CD79B, HLA-DRB5, LTB, KLF2, FCRLA, PHACTR1, CR2, IGHM \n\t   CD40, CD24, TCL1A, GM2A, PLD4, HLA-DQA2, PLAC8, CD180, CTSH, SPIB \nPC_ 3 \nPositive:  HOPX, NKG7, CCL5, KLRD1, KIR2DL4, GZMA, GSTP1, FCER1G, MEF2B, MYO1E \n\t   GAPDH, CD63, ITGA1, GZMB, CST7, SERPINA9, LGALS1, PRF1, RHOC, ACTG1 \n\t   FASLG, RGS13, ID2, CTSW, TMIGD2, SH2D1B, ELL3, CCL4, CLIC3, RUNX3 \nNegative:  TCF7, CD4, PDCD1, SPOCK2, PASK, CD28, IL6R, CD5, CCNA2, IL6ST \n\t   TC2N, UBE2C, TOP2A, TOX2, GPR183, CTLA4, CD6, ACTN1, CCR7, CDCA3 \n\t   GTSE1, KIFC1, LAT, PLK1, AURKB, ICOS, CDCA8, MAF, CDK1, CKAP2L \nPC_ 4 \nPositive:  HLA-DRB1, HLA-DPA1, CAPG, HLA-DPB1, FTL, HLA-DRA, HLA-DQA1, CCNA2, FCER2, KIR2DL4 \n\t   CCL5, HOPX, UBE2C, KLRD1, NKG7, VIM, CDCA3, TUBA1B, HLA-DQB1, GTSE1 \n\t   CDCA8, CD63, KIFC1, AURKB, GZMA, TOP2A, DLGAP5, CKAP2L, MKI67, CD74 \nNegative:  CD27, PDCD1, PASK, TOX2, MEF2B, CD4, TCF7, LAT, CTLA4, CORO1B \n\t   MAF, SERPINA9, IL6R, FKBP5, CD28, SH2D1A, ICOS, RGS13, IL6ST, TC2N \n\t   ISG20, ACTN1, CD6, CD5, SPOCK2, TBC1D4, SMCO4, GNG4, TOX, CD2 \nPC_ 5 \nPositive:  UHRF1, GINS2, CDC6, CDC45, PKMYT1, MCM4, CDT1, TK1, RRM2, TYMS \n\t   PCNA, DTL, MCM7, CLSPN, FEN1, E2F1, ASF1B, MCM10, ESCO2, PAQR4 \n\t   DHFR, MCM6, MCM2, HELLS, RAD51, DSCC1, KIAA0101, RAD54L, CHEK1, MCM3 \nNegative:  CDC20, PLK1, CCNB2, CENPA, CCNB1, HMMR, DLGAP5, CENPE, KIF20A, AURKA \n\t   TROAP, CENPF, ASPM, DEPDC1, TPX2, KIF14, CDCA8, FAM72B, NEK2, KNSTRN \n\t   CDKN3, SGOL2, NUF2, BIRC5, CKAP2L, UBE2C, PIF1, PSRC1, BUB1, CDCA3 \n```\n:::\n\n```{.r .cell-code}\nDimPlot(srat, reduction = \"pca\",dims = c(1,2),group.by = \"orig.ident\")\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nDimPlot(srat, reduction = \"pca\",dims = c(1,2),group.by = \"orig.ident\",split.by = \"orig.ident\")\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nElbowPlot(srat,ndims = 100)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in ElbowPlot(srat, ndims = 100): The object only has information for 75\nreductions\n```\n:::\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsrat <- RunUMAP(srat, dims = 1:25, verbose = F)\nDimPlot(srat)\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsrat <- FindNeighbors(srat, dims = 1:25)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nComputing nearest neighbor graph\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nComputing SNN\n```\n:::\n\n```{.r .cell-code}\nsrat <- FindClusters(srat, resolution = 0.3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 23732\nNumber of edges: 835817\n\nRunning Louvain algorithm...\nMaximum modularity in 10 random starts: 0.9400\nNumber of communities: 13\nElapsed time: 4 seconds\n```\n:::\n\n```{.r .cell-code}\nDimPlot(srat,label.size = 4,repel = T,label = T)\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n## Cell cycle score\n\nA list of cell cycle markers, from Tirosh et al, 2015, is loaded with Seurat. We can segregate this list into markers of G2/M phase and markers of S phase\n\n\n::: {.cell}\n\n```{.r .cell-code}\ns.genes <- cc.genes.updated.2019$s.genes\ns.genes <- c(s.genes,str_to_lower(s.genes))\ng2m.genes <- cc.genes.updated.2019$g2m.genes\ng2m.genes <- c(g2m.genes, str_to_lower(g2m.genes))\nsrat <- CellCycleScoring(srat, s.features = s.genes, g2m.features = g2m.genes, set.ident = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: The following features are not present in the object: mcm5, pcna,\ntyms, fen1, mcm7, mcm4, rrm1, ung, gins2, mcm6, cdca7, dtl, prim1, uhrf1, cenpu,\nhells, rfc2, polr1b, nasp, rad51ap1, gmnn, wdr76, slbp, ccne2, ubr7, pold3,\nmsh2, atad2, rad51, rrm2, cdc45, cdc6, exo1, tipin, dscc1, blm, casp8ap2, usp1,\nclspn, pola1, chaf1b, mrpl36, e2f8, not searching for symbol synonyms\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: The following features are not present in the object: PIMREG, JPT1,\nhmgb2, cdk1, nusap1, ube2c, birc5, tpx2, top2a, ndc80, cks2, nuf2, cks1b, mki67,\ntmpo, cenpf, tacc3, pimreg, smc4, ccnb2, ckap2l, ckap2, aurkb, bub1, kif11,\nanp32e, tubb4b, gtse1, kif20b, hjurp, cdca3, jpt1, cdc20, ttk, cdc25c, kif2c,\nrangap1, ncapd2, dlgap5, cdca2, cdca8, ect2, kif23, hmmr, aurka, psrc1, anln,\nlbr, ckap5, cenpe, ctcf, nek2, g2e3, gas2l3, cbx5, cenpa, not searching for\nsymbol synonyms\n```\n:::\n\n```{.r .cell-code}\n# view cell cycle scores and phase assignments\nhead(srat[[]])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                       orig.ident nCount_RNA nFeature_RNA percent.mt percent.rb\nCol_AAACCTGAGATGCGAC.1          1       4379         1199  3.3340945   45.69536\nCol_AAACCTGAGGAATTAC.1          1       4004         1417  0.7742258   37.06294\nCol_AAACCTGCAGATGGGT.1          1       5819         1969  2.6980581   34.47328\nCol_AAACCTGGTTCGGGCT.1          1       4340         1549  4.0783410   33.66359\nCol_AAACCTGGTTTGCATG.1          1       4899         1768  4.4498877   31.72076\nCol_AAACCTGTCACATGCA.1          1       3668         1352  3.1352236   36.55943\n                       RNA_snn_res.0.3 seurat_clusters     S.Score   G2M.Score\nCol_AAACCTGAGATGCGAC.1               3               3 -0.04526088 -0.06738658\nCol_AAACCTGAGGAATTAC.1               3               3 -0.06310393 -0.02992080\nCol_AAACCTGCAGATGGGT.1               3               3 -0.05474959 -0.06798010\nCol_AAACCTGGTTCGGGCT.1               3               3 -0.05709454  0.00728307\nCol_AAACCTGGTTTGCATG.1               5               5 -0.10716761 -0.05199952\nCol_AAACCTGTCACATGCA.1               3               3  0.01237206 -0.09404912\n                       Phase old.ident\nCol_AAACCTGAGATGCGAC.1    G1         3\nCol_AAACCTGAGGAATTAC.1    G1         3\nCol_AAACCTGCAGATGGGT.1    G1         3\nCol_AAACCTGGTTCGGGCT.1   G2M         3\nCol_AAACCTGGTTTGCATG.1    G1         5\nCol_AAACCTGTCACATGCA.1     S         3\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nDimPlot(srat, reduction = \"umap\",group.by = \"Phase\")\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nFeaturePlot(srat,features = c(\"S.Score\",\"G2M.Score\"),label.size = 4,repel = T,label = T) & \n  theme(plot.title = element_text(size=10))\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nVlnPlot(srat,features = c(\"S.Score\",\"G2M.Score\"),group.by  = \"seurat_clusters\") & \n  theme(plot.title = element_text(size=10))\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n\"We suggest regressing out the difference between the G2M and S phase scores. This means that signals separating non-cycling cells and cycling cells will be maintained, but differences in cell cycle phase amongst proliferating cells (which are often uninteresting), will be regressed out of the data\" From the Seurat official site.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDimPlot(srat, reduction = \"pca\",group.by = \"Phase\")\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#srat$CC.Difference <- srat$S.Score - srat$G2M.Score\n#srat <- ScaleData(srat, vars.to.regress = \"CC.Difference\", features = rownames(srat))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsrat <- readRDS(\"../data/02_cleaned_data/Seurat_colitis_data.RDS\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Now, a PCA on the variable genes no longer returns components associated with cell cycle\nsrat <- RunPCA(srat, features = VariableFeatures(srat), nfeatures.print = 25)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nPC_ 1 \nPositive:  B2M, HLA-A, IFITM1, CD3E, IL32, CD3D, CD7, FYB, CD3G, CD2 \n\t   LCP2, CCL5, CD247, CD96, ITM2A, RARRES3, GIMAP7, ZFP36L2, HCST, SRGN \n\t   CST7, LAT, IL2RB, NKG7, S100A4 \nNegative:  RGS13, MEF2B, STMN1, CDCA7, KIAA0101, ELL3, TYMS, RRM2, UBE2C, CDT1 \n\t   TK1, NUSAP1, BIRC5, POU2AF1, MKI67, MARCKSL1, CCNA2, CDKN3, KIFC1, CCNB2 \n\t   UHRF1, UBE2J1, CDCA3, TOP2A, TCL1A \nPC_ 2 \nPositive:  HLA-DQA1, HLA-DRA, HLA-DPB1, CD79A, CD74, HLA-DQB1, HLA-DRB1, HLA-DPA1, MS4A1, VPREB3 \n\t   CD79B, CD83, FCER2, HLA-DRB5, LTB, FCRLA, KLF2, CR2, PHACTR1, TCL1A \n\t   CD40, IGHM, CD24, GM2A, PLD4 \nNegative:  CD3E, IL32, CD7, CD3D, CCL5, CD3G, HCST, CD247, NKG7, LCP2 \n\t   CD2, FYB, CD96, CST7, IL2RB, SRGN, RARRES3, GAPDH, FYN, TNFAIP3 \n\t   KLRD1, PRKCH, GZMM, ITM2A, ID2 \nPC_ 3 \nPositive:  TCF7, CD4, PDCD1, SPOCK2, PASK, IL6R, CD28, CD5, IL6ST, TOX2 \n\t   TC2N, CTLA4, CD6, ACTN1, LAT, ICOS, GPR183, MAF, CCR7, RRM2 \n\t   SH2D1A, GIMAP4, FBLN7, CTSB, TYMS \nNegative:  HOPX, NKG7, CCL5, KLRD1, KIR2DL4, GZMA, FCER1G, GSTP1, CD63, ITGA1 \n\t   GZMB, MYO1E, CST7, LGALS1, PRF1, RHOC, MEF2B, GAPDH, FASLG, CTSW \n\t   ID2, SH2D1B, TMIGD2, ACTG1, SERPINA9 \nPC_ 4 \nPositive:  HLA-DRB1, HLA-DPA1, FTL, HLA-DPB1, CAPG, FCER2, HLA-DQA1, HLA-DRA, RRM2, TUBA1B \n\t   CCNA2, TYMS, HLA-DQB1, KLF2, VIM, CDK1, ASF1B, KIFC1, KIR2DL4, PKMYT1 \n\t   CCL5, UBE2C, KLRD1, CD74, UHRF1 \nNegative:  CD27, PDCD1, MEF2B, PASK, SERPINA9, RGS13, TOX2, CD4, TCF7, LAT \n\t   CTLA4, ISG20, CORO1B, MAF, DCAF12, IL6R, FKBP5, SH2D1A, ELL3, HMCES \n\t   ICOS, CD28, ACTG1, TOX, IL6ST \nPC_ 5 \nPositive:  IL4I1, NFKBIA, KIT, IL23R, NR4A1, TNFRSF18, KRT86, TYROBP, ZFP36, LINC00299 \n\t   CD83, MAP3K8, TNFRSF4, CDKN1A, TNFSF13B, DUSP1, NR4A2, BHLHE40, PHLDA1, AREG \n\t   BCL2A1, KLF6, KIAA1324, FOS, FOSB \nNegative:  RPL28, GIMAP7, CD8A, GZMM, LEF1, GIMAP4, GIMAP1, CD8B, LINC00861, CD3G \n\t   CXCR3, CD3D, CCL5, AICDA, NELL2, CD3E, S100A10, RPLP0, FYB, CST7 \n\t   IFNG-AS1, SUSD3, GZMK, CD27, RPLP1 \n```\n:::\n\n```{.r .cell-code}\nDimPlot(srat, reduction = \"pca\",group.by = \"Phase\")\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            used   (Mb) gc trigger    (Mb)   max used    (Mb)\nNcells   3466120  185.2    5097011   272.3    5097011   272.3\nVcells 779976759 5950.8 1797224541 13711.8 1793215236 13681.2\n```\n:::\n\n```{.r .cell-code}\nsrat <- RunUMAP(srat, dims = 1:25, verbose = F)\nDimPlot(srat, reduction = \"umap\",group.by = \"Phase\")\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n\n\n\n# Control data set\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmatrix.con <- read.csv(\"../data/01_raw_data/GSE121380_HB1-4_5prime_raw_gene_expression.txt.gz\",sep = \"\\t\",row.names = 1)\ncolnames(matrix.con) <- paste0(\"CTRL_\",colnames(matrix.con))\n\nsrat <- CreateSeuratObject(matrix.con,project = \"RNA editing\",names.field = 2,names.delim = \"[.]\",min.cells = 3, min.features = 200) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Feature names cannot have underscores ('_'), replacing with dashes\n('-')\n```\n:::\n\n```{.r .cell-code}\nsrat[[\"percent.mt\"]] <- PercentageFeatureSet(srat, pattern = \"^MT-\")\nsrat[[\"percent.rb\"]] <- PercentageFeatureSet(srat, pattern = \"^RP[SL]\")\n\nVlnPlot(srat, features = c(\"nFeature_RNA\",\"nCount_RNA\",\"percent.rb\",\"percent.mt\"),ncol = 2,pt.size = 0.1) \n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsrat <- subset(srat, subset = nFeature_RNA > 200 & nFeature_RNA < 4000 & percent.mt < 15 &  nCount_RNA < 30000)\n\nVlnPlot(srat, features = c(\"nFeature_RNA\",\"nCount_RNA\",\"percent.rb\",\"percent.mt\"),ncol = 2,pt.size = 0.1) \n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nFeatureScatter(srat, feature1 = \"nCount_RNA\", feature2 = \"nFeature_RNA\")\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nFeatureScatter(srat, feature1 = \"nCount_RNA\", feature2 = \"percent.mt\")\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(hist(srat$nFeature_RNA/srat$nCount_RNA, breaks = 100))\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-37-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n$breaks\n  [1] 0.030 0.035 0.040 0.045 0.050 0.055 0.060 0.065 0.070 0.075 0.080 0.085\n [13] 0.090 0.095 0.100 0.105 0.110 0.115 0.120 0.125 0.130 0.135 0.140 0.145\n [25] 0.150 0.155 0.160 0.165 0.170 0.175 0.180 0.185 0.190 0.195 0.200 0.205\n [37] 0.210 0.215 0.220 0.225 0.230 0.235 0.240 0.245 0.250 0.255 0.260 0.265\n [49] 0.270 0.275 0.280 0.285 0.290 0.295 0.300 0.305 0.310 0.315 0.320 0.325\n [61] 0.330 0.335 0.340 0.345 0.350 0.355 0.360 0.365 0.370 0.375 0.380 0.385\n [73] 0.390 0.395 0.400 0.405 0.410 0.415 0.420 0.425 0.430 0.435 0.440 0.445\n [85] 0.450 0.455 0.460 0.465 0.470 0.475 0.480 0.485 0.490 0.495 0.500 0.505\n [97] 0.510 0.515 0.520 0.525 0.530 0.535 0.540 0.545 0.550 0.555 0.560 0.565\n[109] 0.570 0.575 0.580 0.585 0.590 0.595 0.600 0.605 0.610 0.615 0.620 0.625\n[121] 0.630 0.635\n\n$counts\n  [1]   1   1   2   1  14  38  81 121 165 182 188 210 201 175 172 164 164 164\n [19] 136 153 117 112 110  94  89  84  98  70  93  78  79  66  55  78  73  73\n [37]  71  77  94 112  84  95 121 113 140 149 152 137 151 202 232 265 275 279\n [55] 291 323 354 321 332 372 358 355 360 333 329 314 291 305 264 249 213 226\n [73] 167 187 158 156 113 122  75  71  74  43  43  42  23  22  26  15  15  10\n [91]   3   6   6   4   2   3   1   1   1   2   0   1   0   0   0   0   2   0\n[109]   0   0   0   0   0   0   1   0   0   0   0   0   1\n\n$density\n  [1] 0.01488427 0.01488427 0.02976855 0.01488427 0.20837985 0.56560244\n  [7] 1.20562626 1.80099725 2.45590534 2.70893801 2.79824366 3.12569770\n [13] 2.99173923 2.60474808 2.56009526 2.44102106 2.44102106 2.44102106\n [19] 2.02426137 2.27729404 1.74146015 1.66703877 1.63727022 1.39912183\n [25] 1.32470045 1.25027908 1.45865893 1.04189923 1.38423755 1.16097343\n [31] 1.17585771 0.98236213 0.81863511 1.16097343 1.08655206 1.08655206\n [37] 1.05678351 1.14608916 1.39912183 1.66703877 1.25027908 1.41400610\n [43] 1.80099725 1.68192305 2.08379847 2.21775694 2.26240976 2.03914564\n [49] 2.24752549 3.00662350 3.45315175 3.94433281 4.09317556 4.15271266\n [55] 4.33132396 4.80762075 5.26903327 4.77785220 4.94157922 5.53695021\n [61] 5.32857037 5.28391754 5.35833891 4.95646350 4.89692640 4.67366228\n [67] 4.33132396 4.53970380 3.92944854 3.70618442 3.17035052 3.36384610\n [73] 2.48567389 2.78335938 2.35171541 2.32194686 1.68192305 1.81588152\n [79] 1.11632061 1.05678351 1.10143633 0.64002381 0.64002381 0.62513954\n [85] 0.34233832 0.32745404 0.38699114 0.22326412 0.22326412 0.14884275\n [91] 0.04465282 0.08930565 0.08930565 0.05953710 0.02976855 0.04465282\n [97] 0.01488427 0.01488427 0.01488427 0.02976855 0.00000000 0.01488427\n[103] 0.00000000 0.00000000 0.00000000 0.00000000 0.02976855 0.00000000\n[109] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000\n[115] 0.01488427 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000\n[121] 0.01488427\n\n$mids\n  [1] 0.0325 0.0375 0.0425 0.0475 0.0525 0.0575 0.0625 0.0675 0.0725 0.0775\n [11] 0.0825 0.0875 0.0925 0.0975 0.1025 0.1075 0.1125 0.1175 0.1225 0.1275\n [21] 0.1325 0.1375 0.1425 0.1475 0.1525 0.1575 0.1625 0.1675 0.1725 0.1775\n [31] 0.1825 0.1875 0.1925 0.1975 0.2025 0.2075 0.2125 0.2175 0.2225 0.2275\n [41] 0.2325 0.2375 0.2425 0.2475 0.2525 0.2575 0.2625 0.2675 0.2725 0.2775\n [51] 0.2825 0.2875 0.2925 0.2975 0.3025 0.3075 0.3125 0.3175 0.3225 0.3275\n [61] 0.3325 0.3375 0.3425 0.3475 0.3525 0.3575 0.3625 0.3675 0.3725 0.3775\n [71] 0.3825 0.3875 0.3925 0.3975 0.4025 0.4075 0.4125 0.4175 0.4225 0.4275\n [81] 0.4325 0.4375 0.4425 0.4475 0.4525 0.4575 0.4625 0.4675 0.4725 0.4775\n [91] 0.4825 0.4875 0.4925 0.4975 0.5025 0.5075 0.5125 0.5175 0.5225 0.5275\n[101] 0.5325 0.5375 0.5425 0.5475 0.5525 0.5575 0.5625 0.5675 0.5725 0.5775\n[111] 0.5825 0.5875 0.5925 0.5975 0.6025 0.6075 0.6125 0.6175 0.6225 0.6275\n[121] 0.6325\n\n$xname\n[1] \"srat$nFeature_RNA/srat$nCount_RNA\"\n\n$equidist\n[1] TRUE\n\nattr(,\"class\")\n[1] \"histogram\"\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsrat <- NormalizeData(srat)\nsrat <- FindVariableFeatures(srat, selection.method = \"vst\", nfeatures = 2000)\ntop10 <- head(VariableFeatures(srat), 15)\nplot1 <- VariableFeaturePlot(srat)\nLabelPoints(plot = plot1, points = top10, repel = TRUE, xnudge = 0, ynudge = 0)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Transformation introduced infinite values in continuous x-axis\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 150 rows containing missing values (geom_point).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: ggrepel: 11 unlabeled data points (too many overlaps). Consider\nincreasing max.overlaps\n```\n:::\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-38-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nall.genes <- rownames(srat)\nsrat <- ScaleData(srat, features = all.genes)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCentering and scaling data matrix\n```\n:::\n\n```{.r .cell-code}\nsrat <- RunPCA(srat, features = VariableFeatures(object = srat),npcs = 75)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nPC_ 1 \nPositive:  VPREB3, MS4A1, HMGA1, TCL1A, BCAS4, LRMP, FCRLA, MEF2B, ODC1, RGS13 \n\t   MZB1, ELL3, CD22, IGLL5, BACH2, DCK, PTTG1, CDCA7, CENPM, SEC11C \n\t   GCSAM, KIAA0101, GCHFR, BIK, NUSAP1, COTL1, KIAA0922, RRM2, TYMS, CR2 \nNegative:  COL3A1, C1S, COL1A2, CALD1, A2M, CXCL14, MFAP4, IGFBP7, COL1A1, SOD3 \n\t   SPARC, FBLN1, RARRES2, DCN, COL6A2, COL6A1, LUM, ADAMDEC1, RBP1, APOE \n\t   MMP2, TMEM176A, TMEM176B, SERPING1, CTSK, SPARCL1, CXCL12, CFD, CFH, PROCR \nPC_ 2 \nPositive:  STMN1, HMGB2, NUSAP1, UBE2C, KIAA0101, BIRC5, TYMS, CCNA2, RRM2, TOP2A \n\t   CDCA3, CDK1, MKI67, CDKN3, KIFC1, TK1, HMGN2, CENPM, CDCA7, PTTG1 \n\t   TPX2, CENPF, HMGB1, AURKB, TUBB, CDT1, CDCA8, CCNB2, GTSE1, RGS13 \nNegative:  FKBP11, HSP90B1, XBP1, DERL3, ITM2C, PRDX4, SRGN, IGHA2, RP11-290F5.1, IGKC \n\t   SDC1, HSPA1B, SEC11C, FYB, S100A4, MYDGF, IRF4, CD7, ZBP1, CCR10 \n\t   RRBP1, AQP3, TXNDC5, SPAG4, IL32, CD3D, GIMAP7, PRDM1, MANF, TNFAIP3 \nPC_ 3 \nPositive:  LYZ, IGSF6, AIF1, CPVL, SERPINA1, FGL2, MS4A6A, TYROBP, MNDA, CLEC10A \n\t   CST3, LGALS2, CSF1R, IL1B, HCK, CD68, CFP, LST1, PILRA, LILRB2 \n\t   CSTA, CLEC7A, FCN1, FCER1G, CD14, CSF3R, CXCL8, CCL3L3, CLEC4A, IER3 \nNegative:  MZB1, FKBP11, DERL3, TNFRSF17, SELM, IGLL5, SEC11C, IGKC, IGHA2, RP11-290F5.1 \n\t   PRDX4, XBP1, SDC1, TXNDC5, RRBP1, CCR10, SPAG4, ERLEC1, TXNDC11, ZBP1 \n\t   UAP1, HSP90B1, MDK, ITM2C, COL1A2, COL3A1, PIM2, LMAN1, MANF, MFAP4 \nPC_ 4 \nPositive:  IL32, CD7, CD3D, CD2, CD3G, CD247, CD96, FYB, CCL5, GIMAP7 \n\t   LAT, GZMM, IL2RB, CST7, IL7R, NKG7, GIMAP4, ITM2A, SCML4, SIRPG \n\t   TNFAIP3, TCF7, ID2, SPOCK2, TMIGD2, CD6, KLRD1, S100A4, CD8A, MATK \nNegative:  HERPUD1, MZB1, DERL3, IGLL5, TNFRSF17, IGKC, PRDX4, SEC11C, IGHA2, RP11-290F5.1 \n\t   RRBP1, XBP1, TXNDC5, HLA-DQA1, SDC1, FKBP11, HLA-DPA1, CCR10, HLA-DQB1, HLA-DRA \n\t   VPREB3, NPC2, SPI1, SPAG4, HSP90B1, IRF4, MS4A1, CTSH, HLA-DRB1, MYDGF \nPC_ 5 \nPositive:  LGALS4, PHGR1, TSPAN8, FABP1, KRT8, C10orf99, SMIM22, FXYD3, ELF3, C19orf33 \n\t   KRT18, S100A14, C15orf48, KLF5, EPCAM, PIGR, GPX2, KRT19, TMEM54, MT1G \n\t   CLDN7, CLDN3, PRR15L, CLDN4, FAM3D, PRSS3, CHP2, STAP2, CDX2, CA2 \nNegative:  COTL1, CD3D, CD7, FYB, CD3G, HLA-DPB1, CD2, CD247, MS4A1, ITGB2 \n\t   HLA-DQB1, LAT, HLA-DQA1, CTSC, CD96, CD83, SPOCK2, HLA-DPA1, GIMAP7, SELL \n\t   HLA-DRA, GZMM, CCL5, IL32, HLA-DRB1, S100A4, NR4A2, GIMAP4, TUBA1A, IL7R \n```\n:::\n\n```{.r .cell-code}\nDimPlot(srat, reduction = \"pca\",dims = c(1,2),group.by = \"orig.ident\")\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-39-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nDimPlot(srat, reduction = \"pca\",dims = c(1,2),group.by = \"orig.ident\",split.by = \"orig.ident\")\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-40-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nElbowPlot(srat,ndims = 100)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in ElbowPlot(srat, ndims = 100): The object only has information for 75\nreductions\n```\n:::\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-41-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsrat <- RunUMAP(srat, dims = 1:25, verbose = F)\nDimPlot(srat)\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-42-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsrat <- FindNeighbors(srat, dims = 1:25)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nComputing nearest neighbor graph\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nComputing SNN\n```\n:::\n\n```{.r .cell-code}\nsrat <- FindClusters(srat, resolution = 0.3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 13437\nNumber of edges: 508861\n\nRunning Louvain algorithm...\nMaximum modularity in 10 random starts: 0.9532\nNumber of communities: 16\nElapsed time: 1 seconds\n```\n:::\n\n```{.r .cell-code}\nDimPlot(srat,label.size = 4,repel = T,label = T)\n```\n\n::: {.cell-output-display}\n![](01A_Seurat_import_clean_files/figure-html/unnamed-chunk-43-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#saveRDS(srat,\"../Seurat_control_data.RDS\")\n```\n:::\n",
    "supporting": [
      "01A_Seurat_import_clean_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}