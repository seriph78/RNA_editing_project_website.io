[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "RNA editing report website",
    "section": "",
    "text": "flowchart TB\n  \n \n  \n  A[(Raw data)] --- t1(cleaning notebook) \n  t1 --> B[(Cleaned data)]\n  B --- t2(COTAN analysis src)  --> C[(COTAN obj)]\n  \n  C --- t3(COTAN clustering src) --> D[(Clustered COTAN obj)] \n  \n  B --- t4(Seurat analysis src) --> E[(Seurat obj)]\n  \n  E --- t3\n  \n  t3 --> CD[(Seurat obj with COTAN cl.)]\n  \n  CD --> t5(Data exploration + Markers +cluster identification notebook) \n  \n  D --> t5\n  \n  t5 --> G[(Seurat obj with cell id)]\n  t5 --> H[(COTAN obj with cell id)]\n  \n  G -->  t6(Exploration & Conclusion notebook) \n  H --> t6\n  \n  \n  classDef src fill:#66cc33;\n  classDef notebook fill:#cc99ff;\n  \n  class t1,t5,t6 notebook;\n  class t2,t3,t4 src;"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "1 + 1\n\n[1] 2"
  },
  {
    "objectID": "IBD/results/01A_Seurat_import_clean.html",
    "href": "IBD/results/01A_Seurat_import_clean.html",
    "title": "IBD pooled dataset cleaning",
    "section": "",
    "text": "library(stringr)\nlibrary(Seurat)\n\nAttaching SeuratObject\n\n\nAttaching sp\n\nlibrary(ggplot2)\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(RColorBrewer)"
  },
  {
    "objectID": "IBD/results/01A_Seurat_import_clean.html#cell-cycle-score",
    "href": "IBD/results/01A_Seurat_import_clean.html#cell-cycle-score",
    "title": "IBD pooled dataset cleaning",
    "section": "Cell cycle score",
    "text": "Cell cycle score\nA list of cell cycle markers, from Tirosh et al, 2015, is loaded with Seurat. We can segregate this list into markers of G2/M phase and markers of S phase\n\ns.genes <- cc.genes.updated.2019$s.genes\ns.genes <- c(s.genes,str_to_lower(s.genes))\ng2m.genes <- cc.genes.updated.2019$g2m.genes\ng2m.genes <- c(g2m.genes, str_to_lower(g2m.genes))\nsrat <- CellCycleScoring(srat, s.features = s.genes, g2m.features = g2m.genes, set.ident = TRUE)\n\nWarning: The following features are not present in the object: mcm5, pcna,\ntyms, fen1, mcm7, mcm4, rrm1, ung, gins2, mcm6, cdca7, dtl, prim1, uhrf1, cenpu,\nhells, rfc2, polr1b, nasp, rad51ap1, gmnn, wdr76, slbp, ccne2, ubr7, pold3,\nmsh2, atad2, rad51, rrm2, cdc45, cdc6, exo1, tipin, dscc1, blm, casp8ap2, usp1,\nclspn, pola1, chaf1b, mrpl36, e2f8, not searching for symbol synonyms\n\n\nWarning: The following features are not present in the object: PIMREG, JPT1,\nhmgb2, cdk1, nusap1, ube2c, birc5, tpx2, top2a, ndc80, cks2, nuf2, cks1b, mki67,\ntmpo, cenpf, tacc3, pimreg, smc4, ccnb2, ckap2l, ckap2, aurkb, bub1, kif11,\nanp32e, tubb4b, gtse1, kif20b, hjurp, cdca3, jpt1, cdc20, ttk, cdc25c, kif2c,\nrangap1, ncapd2, dlgap5, cdca2, cdca8, ect2, kif23, hmmr, aurka, psrc1, anln,\nlbr, ckap5, cenpe, ctcf, nek2, g2e3, gas2l3, cbx5, cenpa, not searching for\nsymbol synonyms\n\n# view cell cycle scores and phase assignments\nhead(srat[[]])\n\n                       orig.ident nCount_RNA nFeature_RNA percent.mt percent.rb\nCol_AAACCTGAGATGCGAC.1          1       4379         1199  3.3340945   45.69536\nCol_AAACCTGAGGAATTAC.1          1       4004         1417  0.7742258   37.06294\nCol_AAACCTGCAGATGGGT.1          1       5819         1969  2.6980581   34.47328\nCol_AAACCTGGTTCGGGCT.1          1       4340         1549  4.0783410   33.66359\nCol_AAACCTGGTTTGCATG.1          1       4899         1768  4.4498877   31.72076\nCol_AAACCTGTCACATGCA.1          1       3668         1352  3.1352236   36.55943\n                       RNA_snn_res.0.3 seurat_clusters     S.Score   G2M.Score\nCol_AAACCTGAGATGCGAC.1               3               3 -0.04526088 -0.06738658\nCol_AAACCTGAGGAATTAC.1               3               3 -0.06310393 -0.02992080\nCol_AAACCTGCAGATGGGT.1               3               3 -0.05474959 -0.06798010\nCol_AAACCTGGTTCGGGCT.1               3               3 -0.05709454  0.00728307\nCol_AAACCTGGTTTGCATG.1               5               5 -0.10716761 -0.05199952\nCol_AAACCTGTCACATGCA.1               3               3  0.01237206 -0.09404912\n                       Phase old.ident\nCol_AAACCTGAGATGCGAC.1    G1         3\nCol_AAACCTGAGGAATTAC.1    G1         3\nCol_AAACCTGCAGATGGGT.1    G1         3\nCol_AAACCTGGTTCGGGCT.1   G2M         3\nCol_AAACCTGGTTTGCATG.1    G1         5\nCol_AAACCTGTCACATGCA.1     S         3\n\n\n\nDimPlot(srat, reduction = \"umap\",group.by = \"Phase\")\n\n\n\n\n\nFeaturePlot(srat,features = c(\"S.Score\",\"G2M.Score\"),label.size = 4,repel = T,label = T) & \n  theme(plot.title = element_text(size=10))\n\n\n\n\n\nVlnPlot(srat,features = c(\"S.Score\",\"G2M.Score\"),group.by  = \"seurat_clusters\") & \n  theme(plot.title = element_text(size=10))\n\n\n\n\n“We suggest regressing out the difference between the G2M and S phase scores. This means that signals separating non-cycling cells and cycling cells will be maintained, but differences in cell cycle phase amongst proliferating cells (which are often uninteresting), will be regressed out of the data” From the Seurat official site.\n\nDimPlot(srat, reduction = \"pca\",group.by = \"Phase\")\n\n\n\n\n\n#srat$CC.Difference <- srat$S.Score - srat$G2M.Score\n#srat <- ScaleData(srat, vars.to.regress = \"CC.Difference\", features = rownames(srat))\n\n\nsrat <- readRDS(\"../data/02_cleaned_data/Seurat_colitis_data.RDS\")\n\n\n# Now, a PCA on the variable genes no longer returns components associated with cell cycle\nsrat <- RunPCA(srat, features = VariableFeatures(srat), nfeatures.print = 25)\n\nPC_ 1 \nPositive:  B2M, HLA-A, IFITM1, CD3E, IL32, CD3D, CD7, FYB, CD3G, CD2 \n       LCP2, CCL5, CD247, CD96, ITM2A, RARRES3, GIMAP7, ZFP36L2, HCST, SRGN \n       CST7, LAT, IL2RB, NKG7, S100A4 \nNegative:  RGS13, MEF2B, STMN1, CDCA7, KIAA0101, ELL3, TYMS, RRM2, UBE2C, CDT1 \n       TK1, NUSAP1, BIRC5, POU2AF1, MKI67, MARCKSL1, CCNA2, CDKN3, KIFC1, CCNB2 \n       UHRF1, UBE2J1, CDCA3, TOP2A, TCL1A \nPC_ 2 \nPositive:  HLA-DQA1, HLA-DRA, HLA-DPB1, CD79A, CD74, HLA-DQB1, HLA-DRB1, HLA-DPA1, MS4A1, VPREB3 \n       CD79B, CD83, FCER2, HLA-DRB5, LTB, FCRLA, KLF2, CR2, PHACTR1, TCL1A \n       CD40, IGHM, CD24, GM2A, PLD4 \nNegative:  CD3E, IL32, CD7, CD3D, CCL5, CD3G, HCST, CD247, NKG7, LCP2 \n       CD2, FYB, CD96, CST7, IL2RB, SRGN, RARRES3, GAPDH, FYN, TNFAIP3 \n       KLRD1, PRKCH, GZMM, ITM2A, ID2 \nPC_ 3 \nPositive:  TCF7, CD4, PDCD1, SPOCK2, PASK, IL6R, CD28, CD5, IL6ST, TOX2 \n       TC2N, CTLA4, CD6, ACTN1, LAT, ICOS, GPR183, MAF, CCR7, RRM2 \n       SH2D1A, GIMAP4, FBLN7, CTSB, TYMS \nNegative:  HOPX, NKG7, CCL5, KLRD1, KIR2DL4, GZMA, FCER1G, GSTP1, CD63, ITGA1 \n       GZMB, MYO1E, CST7, LGALS1, PRF1, RHOC, MEF2B, GAPDH, FASLG, CTSW \n       ID2, SH2D1B, TMIGD2, ACTG1, SERPINA9 \nPC_ 4 \nPositive:  HLA-DRB1, HLA-DPA1, FTL, HLA-DPB1, CAPG, FCER2, HLA-DQA1, HLA-DRA, RRM2, TUBA1B \n       CCNA2, TYMS, HLA-DQB1, KLF2, VIM, CDK1, ASF1B, KIFC1, KIR2DL4, PKMYT1 \n       CCL5, UBE2C, KLRD1, CD74, UHRF1 \nNegative:  CD27, PDCD1, MEF2B, PASK, SERPINA9, RGS13, TOX2, CD4, TCF7, LAT \n       CTLA4, ISG20, CORO1B, MAF, DCAF12, IL6R, FKBP5, SH2D1A, ELL3, HMCES \n       ICOS, CD28, ACTG1, TOX, IL6ST \nPC_ 5 \nPositive:  IL4I1, NFKBIA, KIT, IL23R, NR4A1, TNFRSF18, KRT86, TYROBP, ZFP36, LINC00299 \n       CD83, MAP3K8, TNFRSF4, CDKN1A, TNFSF13B, DUSP1, NR4A2, BHLHE40, PHLDA1, AREG \n       BCL2A1, KLF6, KIAA1324, FOS, FOSB \nNegative:  RPL28, GIMAP7, CD8A, GZMM, LEF1, GIMAP4, GIMAP1, CD8B, LINC00861, CD3G \n       CXCR3, CD3D, CCL5, AICDA, NELL2, CD3E, S100A10, RPLP0, FYB, CST7 \n       IFNG-AS1, SUSD3, GZMK, CD27, RPLP1 \n\nDimPlot(srat, reduction = \"pca\",group.by = \"Phase\")\n\n\n\n\n\ngc()\n\n            used   (Mb) gc trigger    (Mb)   max used    (Mb)\nNcells   3466120  185.2    5097011   272.3    5097011   272.3\nVcells 779976759 5950.8 1797224541 13711.8 1793215236 13681.2\n\nsrat <- RunUMAP(srat, dims = 1:25, verbose = F)\nDimPlot(srat, reduction = \"umap\",group.by = \"Phase\")"
  },
  {
    "objectID": "Crohn_disease/results/01_cleaning_sample69_NB.html",
    "href": "Crohn_disease/results/01_cleaning_sample69_NB.html",
    "title": "Cleaning tamplate notebook",
    "section": "",
    "text": "#library(COTAN)\n#library(data.table)\n#library(Matrix)\n#library(ggrepel)\n#library(factoextra)\n#library(Rtsne)\n#library(utils)\n#library(plotly)\n#library(tidyverse)\n#library(htmlwidgets)\n#library(MASS)\n#library(Seurat)\n#library(dendextend)\ndevtools::load_all(\"../../../COTAN/\")\n\nℹ Loading COTAN"
  },
  {
    "objectID": "Crohn_disease/results/01_cleaning_sample69_NB.html#general-cleaning",
    "href": "Crohn_disease/results/01_cleaning_sample69_NB.html#general-cleaning",
    "title": "Cleaning tamplate notebook",
    "section": "General cleaning",
    "text": "General cleaning\nWe want to remove cell doublets or multiplets and low quality or dying cells (with too high mtRNA percentage).\n\nBy library sizes\nFirst we check the library size (UMI number) with an empirical cumulative distribution function.\n\nECD.plot(obj,y_cut = 12)\n\n\n\n\nSo to start we drop all cell with library size lower then 6.\nThe next plot shows the library size of each cell in a violin and box plot.\n\nsizes <- Matrix::colSums(obj@raw)\n\nobj <- drop.genes.cells(object = obj,cells = names(sizes[ sizes <= 12]))\n\nlibrary.size.plot(obj,split.pattern = \"-\",n.col = 2)\n\nScale for 'y' is already present. Adding another scale for 'y', which will\nreplace the existing scale.\n\n\n\n\n\nWe can subset and drop the unwanted cell by library size.\n\nsizes <- Matrix::colSums(obj@raw)\n\nobj <- drop.genes.cells(object = obj,cells = names(sizes[ sizes > 15000]))\n\nlibrary.size.plot(obj,split.pattern = \"-\",n.col = 2)\n\nScale for 'y' is already present. Adding another scale for 'y', which will\nreplace the existing scale.\n\n\n\n\n\n\ndim(obj@raw)\n\n[1] 19566 20712\n\n\n\n\nBy mitochondrial gene percentage\nWe will next have a look the the percentage of reads coming from mitochondrial genes. This can help to drop dying cells: these cells will have a percentage of mitochondrial reads particularly high.\n\ndf <- mitochondrial.percentage.plot(obj,split.pattern = \"-\",n.col = 2,gene.prefix = \"^MT-\")\n\ndf$plot\n\n\n\n\n\nobj <- drop.genes.cells(object = obj,cells = rownames(df$sizes[df$sizes$mit.percentage > 10,]))\ndf <- mitochondrial.percentage.plot(obj,split.pattern = \"-\",n.col = 2,gene.prefix = \"^MT-\")\n\ndf$plot\n\n\n\n\nWe check again the library size plot\n\nlibrary.size.plot(obj,split.pattern = \"-\",n.col = 2)\n\nScale for 'y' is already present. Adding another scale for 'y', which will\nreplace the existing scale.\n\n\n\n\n\n\nECD.plot(obj,y_cut = 12)\n\n\n\n\n\n\nGene and library size scatter plot\n\nscatter.plot(obj = obj,split.pattern = \"[-]\",n.col = 2)\n\n\n\n\n\nprint(paste(\"Condition \", sample.id ,sep = \"\"))\n\n[1] \"Condition sample69\"\n\n#--------------------------------------\nn_cells = length(get.cell.size(object = obj))\nprint(paste(\"n cells\", n_cells, sep = \" \"))\n\n[1] \"n cells 19499\"\n\nn_it = 1"
  },
  {
    "objectID": "Crohn_disease/results/01_cleaning_sample69_NB.html#cotan-specific-data-cleaning",
    "href": "Crohn_disease/results/01_cleaning_sample69_NB.html#cotan-specific-data-cleaning",
    "title": "Cleaning tamplate notebook",
    "section": "COTAN specific data cleaning",
    "text": "COTAN specific data cleaning\nFirst, we create a directory to store all information regarding the data cleaning.\n\nif(!file.exists(out_dir)){\n  dir.create(file.path(out_dir))\n}\n\nWarning in dir.create(file.path(out_dir)): cannot create dir '../../\nCrohn_disease1/data/02_cleaned_data', reason 'No such file or directory'\n\nif(!file.exists(paste(out_dir,\"cleaning\", sep = \"\"))){   \n  dir.create(file.path(out_dir, \"cleaning\"))\n}\n\nWarning in dir.create(file.path(out_dir, \"cleaning\")): cannot create dir\n'../../Crohn_disease1/data/02_cleaned_data//cleaning', reason 'No such file or\ndirectory'\n\n\n\nttm = clean(obj)\n\n[1] \"Starting\"\n[1] \"Cells/genes selection done\"\n[1] \"Start estimation mu with linear method\"\n[1]  7121 19499\n[1] \"Fun linear DONE\"\n[1] \"raw_norm DONE\"\n[1] \"hclust DONE\"\n     rowname AACACGTGTAGCGT-1 AATATCGAATCGTG-1 ACATCACTAAGCCT-1\n5102   IGHG4         75.54716        168.26412         151.0943\n971     IGKC         75.54716        168.26412         339.9622\n6870   IGLC3         37.77358          0.00000           0.0000\n3886  MALAT1          0.00000          0.00000           0.0000\n6868   IGLL5          0.00000         24.03773           0.0000\n5159     B2M          0.00000          0.00000           0.0000\n6869   IGLC2          0.00000          0.00000           0.0000\n2741   HSPB1          0.00000          0.00000           0.0000\n2103    MZB1          0.00000         24.03773           0.0000\n6736     FTL          0.00000          0.00000           0.0000\n3122   RPL10          0.00000          0.00000           0.0000\n2933  TMSB4X          0.00000         48.07546           0.0000\n2366   RPS18          0.00000          0.00000           0.0000\n3259    RPL7          0.00000          0.00000           0.0000\n3113    SSR4          0.00000          0.00000           0.0000\n     ACATCACTATGCTG-1 ACATCACTATTCTC-1 ACCCAGCTTCACCC-1 ACCTATTGTGTCCC-1\n5102     129.59331352       146.124105        114.96306         66.10376\n971      322.28516451       299.206500         34.48892          0.00000\n6870       0.04468735         0.000000        333.39289         33.05188\n3886       4.02186145         0.000000         11.49631          0.00000\n6868       0.00000000         0.000000          0.00000          0.00000\n5159       2.68124097         0.000000          0.00000         33.05188\n6869       0.04468735         0.000000          0.00000          0.00000\n2741       1.42999518         0.000000          0.00000          0.00000\n2103       0.98312169         0.000000          0.00000          0.00000\n6736       3.57498796         3.479145          0.00000          0.00000\n3122       1.56405723         3.479145          0.00000          0.00000\n2933       0.40218615         0.000000          0.00000          0.00000\n2366       0.35749880         0.000000          0.00000          0.00000\n3259       0.26812410         0.000000          0.00000         33.05188\n3113       1.60874458         3.479145          0.00000          0.00000\n     ACGAACACGTTACG-1 AGGAATGATCAGTG-1 AGGATAGACACTTT-1 AGGGAGTGCTCCAC-1\n5102       141.370421        100.72954      131.0594993         132.2075\n971        329.864316        151.09431      180.4113445         231.3632\n6870         0.000000         50.36477        0.7917408           0.0000\n3886         0.000000          0.00000       14.2513350           0.0000\n6868         0.000000          0.00000       61.7030023           0.0000\n5159         0.000000          0.00000        3.8531387           0.0000\n6869         0.000000          0.00000        1.5834817           0.0000\n2741         5.235942          0.00000        1.5306989           0.0000\n2103         0.000000          0.00000        3.4308769           0.0000\n6736         5.235942          0.00000        2.6919188           0.0000\n3122         0.000000          0.00000        1.5834817           0.0000\n2933         0.000000          0.00000        0.1055654           0.0000\n2366         0.000000         25.18239        1.2140026           0.0000\n3259         0.000000          0.00000        0.3694791           0.0000\n3113         0.000000          0.00000        3.0086152           0.0000\n     ATAACAACTTCGTT-1 ATCACTACGCTGAT-1 ATCGCCTGGAATGA-1 ATGGACACATTTCC-1\n5102         117.5178        139.16581        165.25940         145.8842\n971          156.6904        278.33163        280.94099         328.2394\n6870          19.5863          0.00000          0.00000           0.0000\n3886           0.0000          0.00000          0.00000           0.0000\n6868           0.0000          0.00000          0.00000           0.0000\n5159          19.5863          0.00000          0.00000           0.0000\n6869           0.0000          0.00000          0.00000           0.0000\n2741           0.0000          0.00000          0.00000           0.0000\n2103           0.0000          0.00000          0.00000           0.0000\n6736           0.0000         27.83316         16.52594           0.0000\n3122           0.0000          0.00000          0.00000           0.0000\n2933          19.5863          0.00000          0.00000           0.0000\n2366           0.0000          0.00000          0.00000           0.0000\n3259           0.0000          0.00000          0.00000           0.0000\n3113           0.0000          0.00000          0.00000           0.0000\n     ATTATGGAGCAGTT-1 ATTTCCGAGGGCAA-1 ATTTCCGATGCCAA-1 CAACCGCTCACCAA-1\n5102      207.8849334      273.3872142        216.33958        144.22639\n971       130.2537177      137.4324915        192.30185          0.00000\n6870        0.0000000        0.0000000          0.00000          0.00000\n3886       53.6645317       28.7109352         24.03773          0.00000\n6868        0.0000000        0.2111098          0.00000         48.07546\n5159        0.2605074        1.8999884          0.00000         24.03773\n6869        0.5210149        0.0000000          0.00000          0.00000\n2741        1.5630446        3.5888669          0.00000          0.00000\n2103        3.3865967        1.4777687          0.00000          0.00000\n6736        0.5210149        0.8444393          0.00000          0.00000\n3122        1.0420297        0.2111098          0.00000          0.00000\n2933        0.0000000        0.2111098          0.00000          0.00000\n2366        1.3025372        0.6333295         24.03773          0.00000\n3259        0.2605074        0.0000000          0.00000          0.00000\n3113        1.8235520        0.2111098          0.00000          0.00000\n     CAACCGCTCCAGTA-1 CAACCGCTGCAGTT-1 CAACCGCTTCATTC-1 CAACTTTGGAGGAC-1\n5102        183.94090      207.2049153         271.1949       185.330184\n971         183.94090      102.1782648         135.5975       161.365074\n6870          0.00000        1.1514751           0.0000         0.532558\n3886          0.00000        6.7270388           0.0000        29.290690\n6868         45.98523       62.3614676           0.0000         0.000000\n5159          0.00000        9.3936127           0.0000         1.065116\n6869          0.00000        0.7272474           0.0000         0.532558\n2741          0.00000        1.8181186           0.0000         2.130232\n2103          0.00000        1.5150988           0.0000         0.532558\n6736          0.00000        4.3634846           0.0000         0.000000\n3122          0.00000        1.5150988           0.0000         1.065116\n2933          0.00000        1.1514751           0.0000         0.000000\n2366          0.00000        0.5454356           0.0000         1.597674\n3259          0.00000        0.5454356           0.0000         0.000000\n3113          0.00000        3.1514056           0.0000         3.727906\n     CAACTTTGTGTCGA-1 CAGCGGACTAGCCA-1 CCAGATGAAGGCGA-1 CCAGATGATTGCGA-1\n5102        198.31129        162.71695       132.207523         151.0943\n971         264.41505        244.07543       302.188625         264.4150\n6870          0.00000          0.00000         0.000000           0.0000\n3886         33.05188          0.00000         9.443395           0.0000\n6868          0.00000          0.00000         0.000000           0.0000\n5159          0.00000         40.67924         0.000000           0.0000\n6869          0.00000          0.00000         0.000000           0.0000\n2741          0.00000          0.00000         0.000000           0.0000\n2103          0.00000          0.00000         0.000000           0.0000\n6736          0.00000          0.00000         0.000000           0.0000\n3122          0.00000          0.00000         0.000000           0.0000\n2933          0.00000          0.00000         0.000000           0.0000\n2366          0.00000          0.00000         0.000000           0.0000\n3259          0.00000          0.00000         0.000000           0.0000\n3113          0.00000          0.00000         0.000000           0.0000\n     CCAGCACTATGCTG-1 CCAGCGGACTTCTA-1 CCAGCGGATTGCGA-1 CCCAGTTGAAGGCG-1\n5102        117.51780        168.26412     136.54049406     132.27665760\n971         235.03560        276.43391     298.07816929     312.20978349\n6870          0.00000          0.00000       0.22656055       0.13826828\n3886          0.00000          0.00000       6.23041524       5.06983705\n6868          0.00000          0.00000       0.03776009       0.00000000\n5159         29.37945          0.00000       3.43616841       1.88966654\n6869          0.00000          0.00000       0.07552018       0.00000000\n2741          0.00000         12.01887       2.07680508       0.04608943\n2103          0.00000          0.00000       1.43488351       1.19832512\n6736         29.37945          0.00000       1.96352480       2.76536566\n3122          0.00000         12.01887       0.86848212       0.78352027\n2933          0.00000          0.00000       0.86848212       3.64106479\n2366          0.00000         12.01887       0.26432065       0.23044714\n3259          0.00000          0.00000       0.37760092       0.23044714\n3113          0.00000          0.00000       1.66144406       1.47486169\n     CCCAGTTGTTGACG-1 CCTATTGACTCGAA-1 CCTGCAACCGAGTT-1 CGACAAACTGGATC-1\n5102        113.32073       301.504940         93.32296      204.3536104\n971          75.54716        28.714756         93.32296      107.0975012\n6870          0.00000         2.392896         31.10765        0.2894527\n3886          0.00000         0.000000          0.00000       38.4972099\n6868          0.00000        74.179787          0.00000        0.0000000\n5159          0.00000         4.785793          0.00000        0.5789054\n6869          0.00000         0.000000          0.00000        0.2894527\n2741          0.00000         0.000000          0.00000        1.7367162\n2103          0.00000         0.000000          0.00000        2.3156216\n6736          0.00000         0.000000          0.00000        0.8683581\n3122          0.00000         2.392896          0.00000        2.0261689\n2933          0.00000         4.785793          0.00000        1.4472635\n2366          0.00000         0.000000          0.00000        0.5789054\n3259          0.00000         0.000000          0.00000        0.0000000\n3113          0.00000         2.392896          0.00000        3.4734325\n     CGCGGATGTGACAC-1 CGGACTCTAAAGTG-1 CGGGCATGGGTCTA-1 CGTACCTGCATTCT-1\n5102        113.32073        118.98677      164.0903667        132.20752\n971          75.54716        264.41505       98.6242619        165.25940\n6870         37.77358         13.22075        0.0000000          0.00000\n3886          0.00000          0.00000       60.3648499          0.00000\n6868          0.00000          0.00000        0.0000000          0.00000\n5159          0.00000          0.00000        3.4008366         33.05188\n6869          0.00000          0.00000        0.8502092          0.00000\n2741          0.00000          0.00000        0.0000000          0.00000\n2103          0.00000          0.00000        2.5506275          0.00000\n6736          0.00000          0.00000        1.7004183          0.00000\n3122          0.00000          0.00000        1.7004183         66.10376\n2933          0.00000          0.00000        0.8502092          0.00000\n2366          0.00000          0.00000        1.7004183          0.00000\n3259          0.00000         26.44150        0.0000000          0.00000\n3113          0.00000          0.00000        1.7004183          0.00000\n     CTAACTACCTGAGT-1 CTTTAGACAGAACA-1 GAACGTTGTGTCGA-1 GAAGTCTGAGAGGC-1\n5102      148.7824055        137.10410        151.09431      121.3490999\n971        12.5290447        225.24245        302.18863       55.3696713\n6870      143.5619702          9.79315          0.00000        0.6631098\n3886       75.1742680          0.00000          0.00000       62.6638795\n6868        0.0000000          0.00000          0.00000        0.0000000\n5159        1.5661306          9.79315          0.00000        5.6364336\n6869        1.5661306          0.00000          0.00000        0.3315549\n2741        1.5661306          0.00000          0.00000        4.3102139\n2103        2.0881741          0.00000         37.77358        0.9946648\n6736        0.0000000          0.00000          0.00000        1.6577746\n3122        0.5220435          9.79315          0.00000        4.3102139\n2933        0.5220435          0.00000          0.00000        1.9893295\n2366        0.5220435          0.00000          0.00000        3.6471041\n3259        0.0000000          0.00000          0.00000        2.6524393\n3113        0.0000000          0.00000          0.00000        1.6577746\n     GACAGGGACATACG-1 GACTACGAACGTTG-1 GAGGTGGAAAAACG-1 GAGGTTTGTGTCGA-1\n5102         88.13835      180.1607608        141.02136        229.92613\n971         198.31129      280.5488464         35.25534        160.94829\n6870          0.00000        0.0000000        105.76602          0.00000\n3886          0.00000        0.8963222          0.00000          0.00000\n6868          0.00000        0.8963222         35.25534          0.00000\n5159          0.00000        0.0000000          0.00000          0.00000\n6869         66.10376        0.8963222          0.00000          0.00000\n2741         22.03459        0.0000000          0.00000         22.99261\n2103          0.00000        0.0000000         35.25534          0.00000\n6736          0.00000        0.8963222          0.00000          0.00000\n3122          0.00000        0.0000000          0.00000          0.00000\n2933          0.00000        1.7926444          0.00000          0.00000\n2366          0.00000        0.0000000          0.00000          0.00000\n3259          0.00000        0.0000000          0.00000          0.00000\n3113          0.00000        6.2742554          0.00000          0.00000\n     GAGTGACTTTGTGG-1 GATCATCTATGTCG-1 GATCTTTGAGTCGT-1 GATCTTTGTGTCGA-1\n5102        176.27670        124.43061        231.36317     188.96970624\n971         246.78738         93.32296        165.25940     259.22245263\n6870          0.00000         31.10765          0.00000       0.20363115\n3886          0.00000          0.00000         33.05188       3.29882461\n6868          0.00000          0.00000          0.00000       0.00000000\n5159          0.00000          0.00000          0.00000       1.50687050\n6869          0.00000          0.00000          0.00000       0.04072623\n2741          0.00000          0.00000          0.00000       1.95485903\n2103          0.00000          0.00000          0.00000       1.01815574\n6736          0.00000          0.00000          0.00000       0.97742952\n3122          0.00000          0.00000          0.00000       0.52944099\n2933          0.00000          0.00000          0.00000       0.85525083\n2366          0.00000          0.00000         33.05188       0.36653607\n3259         35.25534          0.00000          0.00000       0.08145246\n3113          0.00000          0.00000          0.00000       1.22178689\n     GATCTTTGTGTGGT-1 GCATGTGAATCAGC-1 GCATGTGATTCCGC-1 GCGTAAACTTCCAT-1\n5102        151.09431     146.93641343       107.025138        124.43061\n971         151.09431     271.51512722       220.345872          0.00000\n6870          0.00000       0.20142072         0.000000         62.21531\n3886         25.18239       7.20079065        25.182385         31.10765\n6868          0.00000       0.00000000         0.000000          0.00000\n5159         25.18239       1.56101056         0.000000         31.10765\n6869          0.00000       0.05035518         0.000000          0.00000\n2741          0.00000       1.96385200         0.000000          0.00000\n2103          0.00000       2.11491753         0.000000          0.00000\n6736          0.00000       2.16527271         6.295596          0.00000\n3122          0.00000       1.40994502        12.591193          0.00000\n2933          0.00000       0.10071036         0.000000          0.00000\n2366          0.00000       0.65461733         0.000000          0.00000\n3259          0.00000       0.40284144         0.000000          0.00000\n3113          0.00000       2.92060040        12.591193          0.00000\n     GCGTAAACTTGCAG-1 GGATACTGAACCAC-1 GGATACTGAACCTG-1 GGATACTGACCCTC-1\n5102       119.105877       148.443535     155.21367951         132.2075\n971          4.083630       343.275675     288.71168368         330.5188\n6870       306.952860         0.000000       0.05933245           0.0000\n3886         0.000000         9.277721       5.93324463           0.0000\n6868         0.000000         0.000000       0.00000000           0.0000\n5159         4.764235         0.000000       1.72064094           0.0000\n6869         2.041815         0.000000       0.00000000           0.0000\n2741         0.680605         0.000000       0.88998669           0.0000\n2103         0.680605         0.000000       0.59332446           0.0000\n6736         1.361210         0.000000       2.13596807           0.0000\n3122         0.000000         0.000000       0.88998669           0.0000\n2933         0.000000         0.000000       0.77132180           0.0000\n2366         0.680605         0.000000       0.35599468           0.0000\n3259         0.000000         0.000000       0.23732979           0.0000\n3113         1.361210         0.000000       0.88998669           0.0000\n     GGATAGCTCGTCTC-1 GTCACCTGTTTCTG-1 GTCTGAGATAAGCC-1 GTTAAATGTTTCTG-1\n5102      163.0971317      245.6589623         155.5383        105.76602\n971       154.0361800        4.0256962         279.9689         35.25534\n6870        0.0000000        6.5875029           0.0000         35.25534\n3886       55.1894335       10.7961853           0.0000          0.00000\n6868        0.0000000       68.3453426           0.0000          0.00000\n5159        0.4118614        3.8427100           0.0000          0.00000\n6869        0.0000000        1.3723964           0.0000         35.25534\n2741        0.4118614        0.9149310           0.0000          0.00000\n2103        2.4711687        3.2022584           0.0000          0.00000\n6736        0.0000000        2.5618067           0.0000          0.00000\n3122        0.8237229        2.8362860           0.0000         35.25534\n2933        0.0000000        0.6404517           0.0000          0.00000\n2366        2.4711687        0.6404517           0.0000          0.00000\n3259        0.0000000        0.8234379           0.0000          0.00000\n3113        1.6474458        2.7447929           0.0000          0.00000\n     TAAACAACAAGTAG-1 TAAACAACCATCAG-1 TAAACAACCATGAC-1 TAAAGTTGCGTGTA-1\n5102        132.20752        122.98374       184.289275        105.76602\n971         264.41505        295.16098       284.446490        211.53204\n6870          0.00000          0.00000         0.000000          0.00000\n3886          0.00000          0.00000         4.006289         35.25534\n6868          0.00000          0.00000         0.000000          0.00000\n5159          0.00000          0.00000         0.000000          0.00000\n6869          0.00000          0.00000         0.000000          0.00000\n2741         13.22075         12.29837         0.000000          0.00000\n2103         13.22075          0.00000         0.000000          0.00000\n6736          0.00000          0.00000         4.006289          0.00000\n3122          0.00000          0.00000         0.000000          0.00000\n2933          0.00000          0.00000         0.000000          0.00000\n2366          0.00000          0.00000         0.000000         35.25534\n3259          0.00000          0.00000         0.000000          0.00000\n3113          0.00000          0.00000         0.000000         35.25534\n     TAAAGTTGGGACTT-1 TAAAGTTGGGGATG-1 TAAAGTTGGTGTTG-1 TAAAGTTGGTTCTT-1\n5102        132.20752        176.27670        119.24600         148.4435\n971         132.20752        141.02136        248.86122         324.7202\n6870          0.00000          0.00000          0.00000           0.0000\n3886         33.05188         35.25534          0.00000           0.0000\n6868          0.00000          0.00000          0.00000           0.0000\n5159          0.00000          0.00000          0.00000           0.0000\n6869         33.05188          0.00000          0.00000           0.0000\n2741          0.00000          0.00000          0.00000           0.0000\n2103          0.00000          0.00000          0.00000           0.0000\n6736         33.05188          0.00000          0.00000           0.0000\n3122          0.00000          0.00000          0.00000           0.0000\n2933          0.00000         35.25534          0.00000           0.0000\n2366          0.00000          0.00000         10.36922           0.0000\n3259          0.00000          0.00000          0.00000           0.0000\n3113          0.00000          0.00000          0.00000           0.0000\n     TAATCCACCAGGAG-1 TAATGTGAATCAGC-1 TAATGTGACGAACT-1 TACAATGACCTATT-1\n5102        127.64864        176.27670         70.51068        381.93285\n971         218.82625        235.03560          0.00000          0.00000\n6870          0.00000          0.00000         35.25534          0.00000\n3886         36.47104          0.00000          0.00000          0.00000\n6868          0.00000          0.00000          0.00000          0.00000\n5159          0.00000          0.00000          0.00000          0.00000\n6869          0.00000          0.00000          0.00000          0.00000\n2741         18.23552          0.00000          0.00000         29.37945\n2103          0.00000          0.00000         35.25534          0.00000\n6736         36.47104          0.00000          0.00000          0.00000\n3122         18.23552          0.00000          0.00000          0.00000\n2933          0.00000          0.00000          0.00000          0.00000\n2366         18.23552          0.00000          0.00000          0.00000\n3259          0.00000          0.00000          0.00000         29.37945\n3113          0.00000         29.37945          0.00000          0.00000\n     TAGAATTGTAGACC-1 TAGGTGTGCGCTAA-1 TATCCTGAATCTCT-1 TATCCTGACCTATT-1\n5102        132.20752         94.43395        166.99898      315.6122933\n971         151.09431          0.00000         83.49949       11.9876479\n6870          0.00000         37.77358          0.00000        0.6243567\n3886         18.88679          0.00000         27.83316        3.4963973\n6868          0.00000          0.00000         55.66633       64.9330930\n5159          0.00000         37.77358          0.00000        4.1831896\n6869          0.00000        113.32073          0.00000        0.6867923\n2741          0.00000         37.77358          0.00000        1.3735847\n2103          0.00000          0.00000          0.00000        1.8730700\n6736          0.00000          0.00000          0.00000        2.2476840\n3122          0.00000          0.00000          0.00000        1.4360203\n2933          0.00000          0.00000         27.83316        0.1248713\n2366          0.00000          0.00000          0.00000        0.5619210\n3259          0.00000          0.00000          0.00000        0.4370497\n3113          0.00000          0.00000          0.00000        2.2476840\n     TATCGTACGTCTGA-1 TATGCGGAATCTCT-1 TATGCGGATTCTGT-1 TATGTCTGCGGGAA-1\n5102      179.6636738      275.7859122         81.35848        113.32073\n971       122.8548515       20.1960145          0.00000          0.00000\n6870        1.8474414        0.5940004          0.00000        113.32073\n3886       52.1902189        7.2128623          0.00000          0.00000\n6868        0.0000000       55.7511829         40.67924          0.00000\n5159        0.4618603        3.7337170          0.00000          0.00000\n6869        0.4618603        0.2545716          0.00000         37.77358\n2741        1.8474414        0.3394288          0.00000          0.00000\n2103        1.3855810        1.4425725         40.67924          0.00000\n6736        0.0000000        1.7820013          0.00000          0.00000\n3122        0.9237207        1.4425725          0.00000          0.00000\n2933        0.4618603        5.2611466          0.00000          0.00000\n2366        1.3855810        0.7637148          0.00000          0.00000\n3259        0.4618603        0.9334292         40.67924          0.00000\n3113        0.0000000        3.9034314          0.00000          0.00000\n     TATTGCTGGCATCA-1 TCCGAGCTTCGACA-1 TCCTAAACAAAGCA-1 TCCTAAACCAACCA-1\n5102         66.10376        198.31129        198.31129       176.276698\n971          66.10376         66.10376         33.05188        20.497290\n6870         33.05188         66.10376          0.00000         0.000000\n3886          0.00000          0.00000         33.05188         8.198916\n6868          0.00000          0.00000          0.00000        28.696207\n5159         33.05188          0.00000          0.00000         0.000000\n6869          0.00000          0.00000          0.00000         0.000000\n2741          0.00000          0.00000          0.00000         0.000000\n2103          0.00000          0.00000          0.00000         4.099458\n6736          0.00000          0.00000          0.00000        12.298374\n3122          0.00000          0.00000          0.00000        12.298374\n2933          0.00000         33.05188          0.00000         4.099458\n2366          0.00000          0.00000          0.00000         0.000000\n3259          0.00000          0.00000          0.00000         0.000000\n3113          0.00000          0.00000          0.00000         0.000000\n     TCCTAAACCAAGCT-1 TCGTAGGAATGTCG-1 TCGTAGGACACTCC-1 TCGTAGGACTGTAG-1\n5102      291.5775599         122.0377         137.1041        181.31318\n971        23.4894519           0.0000           0.0000          0.00000\n6870        0.9069286         406.7924         332.9671        241.75090\n3886        5.8043433           0.0000           0.0000         15.10943\n6868       82.7118926           0.0000           0.0000          0.00000\n5159        5.1694933           0.0000           0.0000          0.00000\n6869        0.3627715           0.0000           0.0000          0.00000\n2741        0.6348501           0.0000          19.5863          0.00000\n2103        1.0883144           0.0000           0.0000          0.00000\n6736        3.5370217           0.0000           0.0000          0.00000\n3122        0.6348501           0.0000           0.0000          0.00000\n2933        0.9976215           0.0000           0.0000          0.00000\n2366        0.5441572           0.0000           0.0000          0.00000\n3259        0.1813857           0.0000           0.0000          0.00000\n3113        1.9952430           0.0000           0.0000          0.00000\n     TCGTAGGACTGTCC-1 TCGTAGGACTTTAC-1 TGATAAACGTTTCT-1 TGATACCTGTTTCT-1\n5102     110.03338749       153.531318        144.22639      132.7734593\n971        1.65576917        17.059035        192.30185      198.6680708\n6870     345.45365840       264.415047          0.00000        0.5413299\n3886       4.62862745         0.000000          0.00000        8.2675838\n6868       0.07526223         0.000000          0.00000       52.3613642\n5159       1.24182688         0.000000          0.00000        5.4625107\n6869       1.91918699         0.000000          0.00000        0.3444827\n2741       1.31708911         8.529518          0.00000        5.0196045\n2103       0.41394229         0.000000          0.00000        2.0668960\n6736       1.20419576         0.000000          0.00000        6.6928060\n3122       0.33868006         0.000000          0.00000        1.3779306\n2933       0.22578670         0.000000          0.00000        5.1672399\n2366       0.30104894         0.000000          0.00000        0.7381771\n3259       0.18815559         0.000000          0.00000        0.2952709\n3113       0.90314682         8.529518         24.03773        2.5098022\n     TGTGAGTGCGTGAT-1 TTAACCACTAGAGA-1 TTAGGGACGTGTCA-1 TTGTACACGTTAGC-1\n5102      275.6402140      189.6203524        105.76602        120.18866\n971        72.9635861       81.6420962         52.88301        192.30185\n6870        1.8708612        2.6336160         26.44150          0.00000\n3886       64.2329006       74.2679713          0.00000         24.03773\n6868        0.0000000        0.0000000          0.00000          0.00000\n5159        0.6236204        1.5801696          0.00000          0.00000\n6869        0.0000000        0.5267232         52.88301          0.00000\n2741        0.6236204        3.6870624          0.00000          0.00000\n2103        0.6236204        2.6336160          0.00000          0.00000\n6736        0.6236204        0.0000000          0.00000          0.00000\n3122        1.2472408        0.5267232          0.00000          0.00000\n2933        0.6236204        2.6336160          0.00000          0.00000\n2366        0.6236204        1.0534464          0.00000          0.00000\n3259        0.0000000        0.0000000          0.00000          0.00000\n3113        1.8708612        3.1603392          0.00000          0.00000\n[1] \"PCA start\"\n[1] \"PCA done\"\n\nobj = ttm$object\n\nttm$pca.cell.2\n\n\n\n\n\nttm$genes.plot\n\nWarning: ggrepel: 12 unlabeled data points (too many overlaps). Consider\nincreasing max.overlaps\n\n\n\n\n\nTo color the PCA based on cells’ RNA extraction efficiency\n\nttm$UDE.plot\n\n\n\n\nUDE (color) should not correlate with principal components! This is very important. The next part is used to remove the cells with efficiency too low.\n\nnu_df = data.frame(\"nu\"= sort(get.nu(obj)), \"n\"=c(1:length(get.nu(obj))))\n\nggplot(nu_df, aes(x = n, y=nu)) + \n    geom_point(colour = \"#8491B4B2\", size=1)\n\n\n\n    #my_theme #+ ylim(0,1) + xlim(0,70)\n\nWe can zoom on the smallest values and, if we detect a clear elbow, we can decide to remove the cells.\n\nyset = 0.38#threshold to remove low UDE cells\nplot.ude <- ggplot(nu_df, aes(x = n, y=nu)) + \n    geom_point(colour = \"#8491B4B2\", size=1) + \n     ylim(0,1) + xlim(0,15000) +\n    geom_hline(yintercept=yset, linetype=\"dashed\", color = \"darkred\") +\n    annotate(geom=\"text\", x=200, y=0.25, \n             label=paste(\"to remove cells with nu < \",yset,sep = \" \"), \n             color=\"darkred\", size=4.5)\n\nplot.ude\n\nWarning: Removed 4499 rows containing missing values (geom_point).\n\n\n\n\n\nFor this round of analysis we want to keep the low UMI cells to keep possible cell population with very low amount of RNA ans neutrophils cells. So we don’t drop cells here.\n\n#saveRDS(obj,paste0(out_dir,sample.id,\"_obj_cotan.RDS\"))"
  }
]